
/*  
	Do not change anything in this file!!!!!!
	This file was automatically generated using a Mathematica notebook
	Only make changes in the corresponding Mathematica notebook and recompile to C++
*/
#include "Binary.hpp"
#include "Constants.hpp"
#include "utils.hpp"
#include <cmath>

high_prec_t Binary::dhdthetaS(params& myParams, high_prec_t t){
	high_prec_t A0 {myParams.gravAmplitude};	
	high_prec_t AU { Constants::AU};
	high_prec_t c {Constants::C};
	high_prec_t fGW {gwFrequency(myParams,t)};
	high_prec_t thetaL { myParams.thetaL};
	high_prec_t phiL { myParams.phiL };
	high_prec_t thetaS {myParams.thetaS};
	high_prec_t phiS {myParams.phiS};
	high_prec_t psiSv { psiS(myParams, t) };
	high_prec_t omegaE {Constants::omegaE};
	high_prec_t Pi { Constants::PI };
	high_prec_t T2 { myParams.lightTwoWayTime };
	high_prec_t P { myParams.P };
	high_prec_t f0 { myParams.freqGW };
	high_prec_t f1 { myParams.f1 };
	high_prec_t K { FrequencyK(myParams) };
	high_prec_t phi0 { myParams.phiP };
	high_prec_t igdir { myParams.ig_direction };
	
	high_prec_t res;
	if (myParams.mission=="LISA") {
		res = (Sqrt(3)*Cos(ArcTan((A0*(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*((Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2)))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/2.,A0*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) + (Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))/2.)) + (Pi*(2*t*(2*f0 + f1*t) + (K*P*(f1*P*Cos(phi0) - f1*P*Cos(phi0 + (2*Pi*t)/P) + 2*f0*Pi*Sin(phi0) - 2*Pi*(f0 + f1*t)*Sin(phi0 + (2*Pi*t)/P)))/Power(Pi,2)))/2. + (2*AU*fGW*Pi*Cos(phiS - omegaE*t)*Sin(thetaS))/c)*(2*Power(A0,2)*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) + (Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))/2.,2) + (Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*(Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(-0.5*(Sqrt(3)*Cos(phiS - omegaE*t)*Cos(thetaS)) - Sin(thetaS)/2.)*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.) - Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*((-2*Sin(phiS - omegaE*t)*Sin(thetaS)*(Cos(phiS - omegaE*t)*Cos(thetaS) - Sqrt(3)*Sin(thetaS)))/(4*Power(Sin(phiS - omegaE*t),2)*Power(Sin(thetaS),2) + Power(Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS),2)) - (2*Cos(thetaS)*Sin(phiS - omegaE*t)*(-(Sqrt(3)*Cos(thetaS)) - Cos(phiS - omegaE*t)*Sin(thetaS)))/(4*Power(Sin(phiS - omegaE*t),2)*Power(Sin(thetaS),2) + Power(Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS),2)))*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) - 2*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*((((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.)*(-((Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))) - (-0.5*(Sqrt(3)*Cos(phiS - omegaE*t)*Cos(thetaS)) - Sin(thetaS)/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. + (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL))/2. - (Sqrt(3)*Sin(omegaE*t)*(-(Cos(phiS)*Cos(thetaL)*Cos(thetaS)) - Cos(phiL)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(Cos(thetaL)*Cos(thetaS)*Sin(phiS) + Sin(phiL)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) - 2*Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*((-2*Sin(phiS - omegaE*t)*Sin(thetaS)*(Cos(phiS - omegaE*t)*Cos(thetaS) - Sqrt(3)*Sin(thetaS)))/(4*Power(Sin(phiS - omegaE*t),2)*Power(Sin(thetaS),2) + Power(Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS),2)) - (2*Cos(thetaS)*Sin(phiS - omegaE*t)*(-(Sqrt(3)*Cos(thetaS)) - Cos(phiS - omegaE*t)*Sin(thetaS)))/(4*Power(Sin(phiS - omegaE*t),2)*Power(Sin(thetaS),2) + Power(Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) - Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*((((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.)*(-((Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))) - (-0.5*(Sqrt(3)*Cos(phiS - omegaE*t)*Cos(thetaS)) - Sin(thetaS)/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. + (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL))/2. - (Sqrt(3)*Sin(omegaE*t)*(-(Cos(phiS)*Cos(thetaL)*Cos(thetaS)) - Cos(phiL)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(Cos(thetaL)*Cos(thetaS)*Sin(phiS) + Sin(phiL)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) - (-0.5*(Sqrt(3)*Cos(phiS - omegaE*t)*Cos(thetaS)) - Sin(thetaS)/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))*((Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2)))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/2. + Power(A0,2)*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*Power((Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2)))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2) + 2*Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) + (Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))/2.)*(2*Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*((-2*Sin(phiS - omegaE*t)*Sin(thetaS)*(Cos(phiS - omegaE*t)*Cos(thetaS) - Sqrt(3)*Sin(thetaS)))/(4*Power(Sin(phiS - omegaE*t),2)*Power(Sin(thetaS),2) + Power(Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS),2)) - (2*Cos(thetaS)*Sin(phiS - omegaE*t)*(-(Sqrt(3)*Cos(thetaS)) - Cos(phiS - omegaE*t)*Sin(thetaS)))/(4*Power(Sin(phiS - omegaE*t),2)*Power(Sin(thetaS),2) + Power(Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS),2))) + Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*((((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.)*(-((Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))) - (-0.5*(Sqrt(3)*Cos(phiS - omegaE*t)*Cos(thetaS)) - Sin(thetaS)/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. + (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL))/2. - (Sqrt(3)*Sin(omegaE*t)*(-(Cos(phiS)*Cos(thetaL)*Cos(thetaS)) - Cos(phiL)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(Cos(thetaL)*Cos(thetaS)*Sin(phiS) + Sin(phiL)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) + Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(-0.5*(Sqrt(3)*Cos(phiS - omegaE*t)*Cos(thetaS)) - Sin(thetaS)/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) + Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(-0.5*(Sqrt(3)*Cos(phiS - omegaE*t)*Cos(thetaS)) - Sin(thetaS)/2.)*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) - (1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*((-2*Sin(phiS - omegaE*t)*Sin(thetaS)*(Cos(phiS - omegaE*t)*Cos(thetaS) - Sqrt(3)*Sin(thetaS)))/(4*Power(Sin(phiS - omegaE*t),2)*Power(Sin(thetaS),2) + Power(Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS),2)) - (2*Cos(thetaS)*Sin(phiS - omegaE*t)*(-(Sqrt(3)*Cos(thetaS)) - Cos(phiS - omegaE*t)*Sin(thetaS)))/(4*Power(Sin(phiS - omegaE*t),2)*Power(Sin(thetaS),2) + Power(Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS),2)))*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) - 2*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*((((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.)*(-((Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))) - (-0.5*(Sqrt(3)*Cos(phiS - omegaE*t)*Cos(thetaS)) - Sin(thetaS)/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. + (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL))/2. - (Sqrt(3)*Sin(omegaE*t)*(-(Cos(phiS)*Cos(thetaL)*Cos(thetaS)) - Cos(phiL)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(Cos(thetaL)*Cos(thetaS)*Sin(phiS) + Sin(phiL)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))))/(4.*Sqrt(Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) + (Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))/2.,2) + (Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power((Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2)))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4.)) - (Sqrt(3)*Sqrt(Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) + (Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))/2.,2) + (Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power((Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2)))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4.)*((2*AU*fGW*Pi*Cos(phiS - omegaE*t)*Cos(thetaS))/c - (A0*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) + (Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))/2.)*((A0*(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(-0.5*(Sqrt(3)*Cos(phiS - omegaE*t)*Cos(thetaS)) - Sin(thetaS)/2.)*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.) - Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*((-2*Sin(phiS - omegaE*t)*Sin(thetaS)*(Cos(phiS - omegaE*t)*Cos(thetaS) - Sqrt(3)*Sin(thetaS)))/(4*Power(Sin(phiS - omegaE*t),2)*Power(Sin(thetaS),2) + Power(Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS),2)) - (2*Cos(thetaS)*Sin(phiS - omegaE*t)*(-(Sqrt(3)*Cos(thetaS)) - Cos(phiS - omegaE*t)*Sin(thetaS)))/(4*Power(Sin(phiS - omegaE*t),2)*Power(Sin(thetaS),2) + Power(Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS),2)))*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) - 2*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*((((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.)*(-((Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))) - (-0.5*(Sqrt(3)*Cos(phiS - omegaE*t)*Cos(thetaS)) - Sin(thetaS)/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. + (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL))/2. - (Sqrt(3)*Sin(omegaE*t)*(-(Cos(phiS)*Cos(thetaL)*Cos(thetaS)) - Cos(phiL)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(Cos(thetaL)*Cos(thetaS)*Sin(phiS) + Sin(phiL)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) - 2*Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*((-2*Sin(phiS - omegaE*t)*Sin(thetaS)*(Cos(phiS - omegaE*t)*Cos(thetaS) - Sqrt(3)*Sin(thetaS)))/(4*Power(Sin(phiS - omegaE*t),2)*Power(Sin(thetaS),2) + Power(Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS),2)) - (2*Cos(thetaS)*Sin(phiS - omegaE*t)*(-(Sqrt(3)*Cos(thetaS)) - Cos(phiS - omegaE*t)*Sin(thetaS)))/(4*Power(Sin(phiS - omegaE*t),2)*Power(Sin(thetaS),2) + Power(Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) - Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*((((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.)*(-((Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))) - (-0.5*(Sqrt(3)*Cos(phiS - omegaE*t)*Cos(thetaS)) - Sin(thetaS)/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. + (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL))/2. - (Sqrt(3)*Sin(omegaE*t)*(-(Cos(phiS)*Cos(thetaL)*Cos(thetaS)) - Cos(phiL)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(Cos(thetaL)*Cos(thetaS)*Sin(phiS) + Sin(phiL)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) - (-0.5*(Sqrt(3)*Cos(phiS - omegaE*t)*Cos(thetaS)) - Sin(thetaS)/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/2. + A0*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*((Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2)))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))))/(Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) + (Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))/2.,2) + (Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power((Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2)))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4.) + (A0*(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*((Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2)))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))*(A0*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) + (Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))/2.) + A0*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(2*Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*((-2*Sin(phiS - omegaE*t)*Sin(thetaS)*(Cos(phiS - omegaE*t)*Cos(thetaS) - Sqrt(3)*Sin(thetaS)))/(4*Power(Sin(phiS - omegaE*t),2)*Power(Sin(thetaS),2) + Power(Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS),2)) - (2*Cos(thetaS)*Sin(phiS - omegaE*t)*(-(Sqrt(3)*Cos(thetaS)) - Cos(phiS - omegaE*t)*Sin(thetaS)))/(4*Power(Sin(phiS - omegaE*t),2)*Power(Sin(thetaS),2) + Power(Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS),2))) + Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*((((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.)*(-((Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))) - (-0.5*(Sqrt(3)*Cos(phiS - omegaE*t)*Cos(thetaS)) - Sin(thetaS)/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. + (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL))/2. - (Sqrt(3)*Sin(omegaE*t)*(-(Cos(phiS)*Cos(thetaL)*Cos(thetaS)) - Cos(phiL)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(Cos(thetaL)*Cos(thetaS)*Sin(phiS) + Sin(phiL)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) + Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(-0.5*(Sqrt(3)*Cos(phiS - omegaE*t)*Cos(thetaS)) - Sin(thetaS)/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) + Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(-0.5*(Sqrt(3)*Cos(phiS - omegaE*t)*Cos(thetaS)) - Sin(thetaS)/2.)*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) - (1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*((-2*Sin(phiS - omegaE*t)*Sin(thetaS)*(Cos(phiS - omegaE*t)*Cos(thetaS) - Sqrt(3)*Sin(thetaS)))/(4*Power(Sin(phiS - omegaE*t),2)*Power(Sin(thetaS),2) + Power(Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS),2)) - (2*Cos(thetaS)*Sin(phiS - omegaE*t)*(-(Sqrt(3)*Cos(thetaS)) - Cos(phiS - omegaE*t)*Sin(thetaS)))/(4*Power(Sin(phiS - omegaE*t),2)*Power(Sin(thetaS),2) + Power(Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS),2)))*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) - 2*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*((((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.)*(-((Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))) - (-0.5*(Sqrt(3)*Cos(phiS - omegaE*t)*Cos(thetaS)) - Sin(thetaS)/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. + (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL))/2. - (Sqrt(3)*Sin(omegaE*t)*(-(Cos(phiS)*Cos(thetaL)*Cos(thetaS)) - Cos(phiL)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(Cos(thetaL)*Cos(thetaS)*Sin(phiS) + Sin(phiL)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))))/(2.*(Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) + (Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))/2.,2) + (Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power((Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2)))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4.)))*Sin(ArcTan((A0*(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*((Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2)))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/2.,A0*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) + (Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))/2.)) + (Pi*(2*t*(2*f0 + f1*t) + (K*P*(f1*P*Cos(phi0) - f1*P*Cos(phi0 + (2*Pi*t)/P) + 2*f0*Pi*Sin(phi0) - 2*Pi*(f0 + f1*t)*Sin(phi0 + (2*Pi*t)/P)))/Power(Pi,2)))/2. + (2*AU*fGW*Pi*Cos(phiS - omegaE*t)*Sin(thetaS))/c))/2.;
	} else if (myParams.mission=="IceGiant"){
		res = (-2*Power(Cos(igdir - phiS),3)*Cos(thetaS)*Cos(ArcTan((2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))) + (Pi*(2*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.)*(2*f0 + f1*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.)) + (K*P*(f1*P*Cos(phi0) - f1*P*Cos(phi0 + (2*Pi*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.))/P) + 2*f0*Pi*Sin(phi0) - 2*Pi*(f0 + f1*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.))*Sin(phi0 + (2*Pi*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.))/P)))/Power(Pi,2)))/2.)*Power(Sin(thetaS),2)*Sqrt((Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4. + Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2)))/Power(1 - Power(Cos(igdir - phiS),2)*Power(Sin(thetaS),2),2) + (Power(Cos(igdir - phiS),2)*Cos(thetaS)*Cos(ArcTan((2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))) + (Pi*(2*t*(2*f0 + f1*t) + (K*P*(f1*P*Cos(phi0) - f1*P*Cos(phi0 + (2*Pi*t)/P) + 2*f0*Pi*Sin(phi0) - 2*Pi*(f0 + f1*t)*Sin(phi0 + (2*Pi*t)/P)))/Power(Pi,2)))/2.)*Sin(thetaS)*(-1 + Cos(igdir - phiS)*Sin(thetaS))*Sqrt((Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4. + Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2)))/Power(1 - Power(Cos(igdir - phiS),2)*Power(Sin(thetaS),2),2) + (Power(Cos(igdir - phiS),2)*Cos(thetaS)*Cos(ArcTan((2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))) + (Pi*(2*(2*f0 + f1*(t - T2))*(t - T2) + (K*P*(f1*P*Cos(phi0) - f1*P*Cos(phi0 + (2*Pi*(t - T2))/P) + 2*f0*Pi*Sin(phi0) - 2*Pi*(f0 + f1*(t - T2))*Sin(phi0 + (2*Pi*(t - T2))/P)))/Power(Pi,2)))/2.)*Sin(thetaS)*(1 + Cos(igdir - phiS)*Sin(thetaS))*Sqrt((Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4. + Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2)))/Power(1 - Power(Cos(igdir - phiS),2)*Power(Sin(thetaS),2),2) + (Cos(igdir - phiS)*Cos(thetaS)*Cos(ArcTan((2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))) + (Pi*(2*t*(2*f0 + f1*t) + (K*P*(f1*P*Cos(phi0) - f1*P*Cos(phi0 + (2*Pi*t)/P) + 2*f0*Pi*Sin(phi0) - 2*Pi*(f0 + f1*t)*Sin(phi0 + (2*Pi*t)/P)))/Power(Pi,2)))/2.)*Sqrt((Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4. + Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2)))/(2.*(1 - Power(Cos(igdir - phiS),2)*Power(Sin(thetaS),2))) + (Cos(igdir - phiS)*Cos(thetaS)*Cos(ArcTan((2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))) + (Pi*(2*(2*f0 + f1*(t - T2))*(t - T2) + (K*P*(f1*P*Cos(phi0) - f1*P*Cos(phi0 + (2*Pi*(t - T2))/P) + 2*f0*Pi*Sin(phi0) - 2*Pi*(f0 + f1*(t - T2))*Sin(phi0 + (2*Pi*(t - T2))/P)))/Power(Pi,2)))/2.)*Sqrt((Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4. + Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2)))/(2.*(1 - Power(Cos(igdir - phiS),2)*Power(Sin(thetaS),2))) - (Cos(igdir - phiS)*Cos(thetaS)*Cos(ArcTan((2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))) + (Pi*(2*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.)*(2*f0 + f1*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.)) + (K*P*(f1*P*Cos(phi0) - f1*P*Cos(phi0 + (2*Pi*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.))/P) + 2*f0*Pi*Sin(phi0) - 2*Pi*(f0 + f1*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.))*Sin(phi0 + (2*Pi*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.))/P)))/Power(Pi,2)))/2.)*Sqrt((Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4. + Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2)))/(1 - Power(Cos(igdir - phiS),2)*Power(Sin(thetaS),2)) - (Cos(igdir - phiS)*Cos(ArcTan((2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))) + (Pi*(2*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.)*(2*f0 + f1*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.)) + (K*P*(f1*P*Cos(phi0) - f1*P*Cos(phi0 + (2*Pi*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.))/P) + 2*f0*Pi*Sin(phi0) - 2*Pi*(f0 + f1*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.))*Sin(phi0 + (2*Pi*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.))/P)))/Power(Pi,2)))/2.)*Sin(thetaS)*(Power(A0,2)*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2) + 2*Power(A0,2)*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2) + 2*Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))*(2*Cos(igdir - phiS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS)*Sin(thetaS) + 2*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*((((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.)*(-(Cos(thetaS)*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))) + Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL))/2. - (Sqrt(3)*Sin(igdir)*(-(Cos(phiS)*Cos(thetaL)*Cos(thetaS)) - Cos(phiL)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(Cos(thetaL)*Cos(thetaS)*Sin(phiS) + Sin(phiL)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) - 2*Power(Cos(igdir - phiS),2)*Cos(thetaS)*Sin(thetaS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) + 4*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*((((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.)*(-(Cos(thetaS)*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))) + Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL))/2. - (Sqrt(3)*Sin(igdir)*(-(Cos(phiS)*Cos(thetaL)*Cos(thetaS)) - Cos(phiL)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(Cos(thetaL)*Cos(thetaS)*Sin(phiS) + Sin(phiL)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))) + (Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))*(-2*Power(Cos(igdir - phiS),2)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(thetaS) + 4*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS)*((((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.)*(-(Cos(thetaS)*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))) + Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL))/2. - (Sqrt(3)*Sin(igdir)*(-(Cos(phiS)*Cos(thetaL)*Cos(thetaS)) - Cos(phiL)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(Cos(thetaL)*Cos(thetaS)*Sin(phiS) + Sin(phiL)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) - 2*Cos(igdir - phiS)*Sin(igdir - phiS)*Sin(thetaS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) - 2*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*((((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.)*(-(Cos(thetaS)*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))) + Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL))/2. - (Sqrt(3)*Sin(igdir)*(-(Cos(phiS)*Cos(thetaL)*Cos(thetaS)) - Cos(phiL)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(Cos(thetaL)*Cos(thetaS)*Sin(phiS) + Sin(phiL)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/2.))/(2.*(1 - Power(Cos(igdir - phiS),2)*Power(Sin(thetaS),2))*Sqrt((Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4. + Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))) + (Cos(ArcTan((2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))) + (Pi*(2*t*(2*f0 + f1*t) + (K*P*(f1*P*Cos(phi0) - f1*P*Cos(phi0 + (2*Pi*t)/P) + 2*f0*Pi*Sin(phi0) - 2*Pi*(f0 + f1*t)*Sin(phi0 + (2*Pi*t)/P)))/Power(Pi,2)))/2.)*(-1 + Cos(igdir - phiS)*Sin(thetaS))*(Power(A0,2)*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2) + 2*Power(A0,2)*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2) + 2*Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))*(2*Cos(igdir - phiS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS)*Sin(thetaS) + 2*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*((((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.)*(-(Cos(thetaS)*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))) + Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL))/2. - (Sqrt(3)*Sin(igdir)*(-(Cos(phiS)*Cos(thetaL)*Cos(thetaS)) - Cos(phiL)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(Cos(thetaL)*Cos(thetaS)*Sin(phiS) + Sin(phiL)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) - 2*Power(Cos(igdir - phiS),2)*Cos(thetaS)*Sin(thetaS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) + 4*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*((((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.)*(-(Cos(thetaS)*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))) + Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL))/2. - (Sqrt(3)*Sin(igdir)*(-(Cos(phiS)*Cos(thetaL)*Cos(thetaS)) - Cos(phiL)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(Cos(thetaL)*Cos(thetaS)*Sin(phiS) + Sin(phiL)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))) + (Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))*(-2*Power(Cos(igdir - phiS),2)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(thetaS) + 4*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS)*((((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.)*(-(Cos(thetaS)*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))) + Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL))/2. - (Sqrt(3)*Sin(igdir)*(-(Cos(phiS)*Cos(thetaL)*Cos(thetaS)) - Cos(phiL)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(Cos(thetaL)*Cos(thetaS)*Sin(phiS) + Sin(phiL)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) - 2*Cos(igdir - phiS)*Sin(igdir - phiS)*Sin(thetaS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) - 2*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*((((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.)*(-(Cos(thetaS)*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))) + Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL))/2. - (Sqrt(3)*Sin(igdir)*(-(Cos(phiS)*Cos(thetaL)*Cos(thetaS)) - Cos(phiL)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(Cos(thetaL)*Cos(thetaS)*Sin(phiS) + Sin(phiL)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/2.))/(4.*(1 - Power(Cos(igdir - phiS),2)*Power(Sin(thetaS),2))*Sqrt((Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4. + Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))) + (Cos(ArcTan((2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))) + (Pi*(2*(2*f0 + f1*(t - T2))*(t - T2) + (K*P*(f1*P*Cos(phi0) - f1*P*Cos(phi0 + (2*Pi*(t - T2))/P) + 2*f0*Pi*Sin(phi0) - 2*Pi*(f0 + f1*(t - T2))*Sin(phi0 + (2*Pi*(t - T2))/P)))/Power(Pi,2)))/2.)*(1 + Cos(igdir - phiS)*Sin(thetaS))*(Power(A0,2)*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2) + 2*Power(A0,2)*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2) + 2*Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))*(2*Cos(igdir - phiS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS)*Sin(thetaS) + 2*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*((((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.)*(-(Cos(thetaS)*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))) + Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL))/2. - (Sqrt(3)*Sin(igdir)*(-(Cos(phiS)*Cos(thetaL)*Cos(thetaS)) - Cos(phiL)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(Cos(thetaL)*Cos(thetaS)*Sin(phiS) + Sin(phiL)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) - 2*Power(Cos(igdir - phiS),2)*Cos(thetaS)*Sin(thetaS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) + 4*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*((((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.)*(-(Cos(thetaS)*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))) + Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL))/2. - (Sqrt(3)*Sin(igdir)*(-(Cos(phiS)*Cos(thetaL)*Cos(thetaS)) - Cos(phiL)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(Cos(thetaL)*Cos(thetaS)*Sin(phiS) + Sin(phiL)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))) + (Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))*(-2*Power(Cos(igdir - phiS),2)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(thetaS) + 4*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS)*((((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.)*(-(Cos(thetaS)*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))) + Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL))/2. - (Sqrt(3)*Sin(igdir)*(-(Cos(phiS)*Cos(thetaL)*Cos(thetaS)) - Cos(phiL)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(Cos(thetaL)*Cos(thetaS)*Sin(phiS) + Sin(phiL)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) - 2*Cos(igdir - phiS)*Sin(igdir - phiS)*Sin(thetaS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) - 2*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*((((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.)*(-(Cos(thetaS)*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))) + Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL))/2. - (Sqrt(3)*Sin(igdir)*(-(Cos(phiS)*Cos(thetaL)*Cos(thetaS)) - Cos(phiL)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(Cos(thetaL)*Cos(thetaS)*Sin(phiS) + Sin(phiL)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/2.))/(4.*(1 - Power(Cos(igdir - phiS),2)*Power(Sin(thetaS),2))*Sqrt((Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4. + Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))) - ((-1 + Cos(igdir - phiS)*Sin(thetaS))*Sqrt((Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4. + Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))*((-4*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/(Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))) + (2*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))) + (2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(2*Cos(igdir - phiS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS)*Sin(thetaS) + 2*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*((((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.)*(-(Cos(thetaS)*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))) + Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL))/2. - (Sqrt(3)*Sin(igdir)*(-(Cos(phiS)*Cos(thetaL)*Cos(thetaS)) - Cos(phiL)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(Cos(thetaL)*Cos(thetaS)*Sin(phiS) + Sin(phiL)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) - 2*Power(Cos(igdir - phiS),2)*Cos(thetaS)*Sin(thetaS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) + 4*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*((((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.)*(-(Cos(thetaS)*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))) + Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL))/2. - (Sqrt(3)*Sin(igdir)*(-(Cos(phiS)*Cos(thetaL)*Cos(thetaS)) - Cos(phiL)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(Cos(thetaL)*Cos(thetaS)*Sin(phiS) + Sin(phiL)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))) - (2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))*(-2*Power(Cos(igdir - phiS),2)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(thetaS) + 4*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS)*((((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.)*(-(Cos(thetaS)*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))) + Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL))/2. - (Sqrt(3)*Sin(igdir)*(-(Cos(phiS)*Cos(thetaL)*Cos(thetaS)) - Cos(phiL)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(Cos(thetaL)*Cos(thetaS)*Sin(phiS) + Sin(phiL)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) - 2*Cos(igdir - phiS)*Sin(igdir - phiS)*Sin(thetaS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) - 2*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*((((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.)*(-(Cos(thetaS)*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))) + Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL))/2. - (Sqrt(3)*Sin(igdir)*(-(Cos(phiS)*Cos(thetaL)*Cos(thetaS)) - Cos(phiL)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(Cos(thetaL)*Cos(thetaS)*Sin(phiS) + Sin(phiL)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2)))*Sin(ArcTan((2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))) + (Pi*(2*t*(2*f0 + f1*t) + (K*P*(f1*P*Cos(phi0) - f1*P*Cos(phi0 + (2*Pi*t)/P) + 2*f0*Pi*Sin(phi0) - 2*Pi*(f0 + f1*t)*Sin(phi0 + (2*Pi*t)/P)))/Power(Pi,2)))/2.))/(2.*(1 - Power(Cos(igdir - phiS),2)*Power(Sin(thetaS),2))*(1 + (4*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/(Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2)))) - ((1 + Cos(igdir - phiS)*Sin(thetaS))*Sqrt((Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4. + Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))*((-4*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/(Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))) + (2*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))) + (2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(2*Cos(igdir - phiS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS)*Sin(thetaS) + 2*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*((((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.)*(-(Cos(thetaS)*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))) + Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL))/2. - (Sqrt(3)*Sin(igdir)*(-(Cos(phiS)*Cos(thetaL)*Cos(thetaS)) - Cos(phiL)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(Cos(thetaL)*Cos(thetaS)*Sin(phiS) + Sin(phiL)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) - 2*Power(Cos(igdir - phiS),2)*Cos(thetaS)*Sin(thetaS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) + 4*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*((((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.)*(-(Cos(thetaS)*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))) + Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL))/2. - (Sqrt(3)*Sin(igdir)*(-(Cos(phiS)*Cos(thetaL)*Cos(thetaS)) - Cos(phiL)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(Cos(thetaL)*Cos(thetaS)*Sin(phiS) + Sin(phiL)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))) - (2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))*(-2*Power(Cos(igdir - phiS),2)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(thetaS) + 4*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS)*((((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.)*(-(Cos(thetaS)*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))) + Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL))/2. - (Sqrt(3)*Sin(igdir)*(-(Cos(phiS)*Cos(thetaL)*Cos(thetaS)) - Cos(phiL)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(Cos(thetaL)*Cos(thetaS)*Sin(phiS) + Sin(phiL)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) - 2*Cos(igdir - phiS)*Sin(igdir - phiS)*Sin(thetaS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) - 2*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*((((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.)*(-(Cos(thetaS)*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))) + Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL))/2. - (Sqrt(3)*Sin(igdir)*(-(Cos(phiS)*Cos(thetaL)*Cos(thetaS)) - Cos(phiL)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(Cos(thetaL)*Cos(thetaS)*Sin(phiS) + Sin(phiL)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2)))*Sin(ArcTan((2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))) + (Pi*(2*(2*f0 + f1*(t - T2))*(t - T2) + (K*P*(f1*P*Cos(phi0) - f1*P*Cos(phi0 + (2*Pi*(t - T2))/P) + 2*f0*Pi*Sin(phi0) - 2*Pi*(f0 + f1*(t - T2))*Sin(phi0 + (2*Pi*(t - T2))/P)))/Power(Pi,2)))/2.))/(2.*(1 - Power(Cos(igdir - phiS),2)*Power(Sin(thetaS),2))*(1 + (4*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/(Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2)))) + (Cos(igdir - phiS)*Sin(thetaS)*Sqrt((Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4. + Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))*((Pi*(-(f1*T2*Cos(igdir - phiS)*Cos(thetaS)*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.)) + 2*K*T2*Cos(igdir - phiS)*Cos(thetaS)*Cos(phi0 + (2*Pi*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.))/P)*(f0 + f1*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.)) - T2*Cos(igdir - phiS)*Cos(thetaS)*(2*f0 + f1*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.))))/2. + ((-4*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/(Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))) + (2*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))) + (2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(2*Cos(igdir - phiS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS)*Sin(thetaS) + 2*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*((((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.)*(-(Cos(thetaS)*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))) + Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL))/2. - (Sqrt(3)*Sin(igdir)*(-(Cos(phiS)*Cos(thetaL)*Cos(thetaS)) - Cos(phiL)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(Cos(thetaL)*Cos(thetaS)*Sin(phiS) + Sin(phiL)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) - 2*Power(Cos(igdir - phiS),2)*Cos(thetaS)*Sin(thetaS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) + 4*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*((((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.)*(-(Cos(thetaS)*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))) + Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL))/2. - (Sqrt(3)*Sin(igdir)*(-(Cos(phiS)*Cos(thetaL)*Cos(thetaS)) - Cos(phiL)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(Cos(thetaL)*Cos(thetaS)*Sin(phiS) + Sin(phiL)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))) - (2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))*(-2*Power(Cos(igdir - phiS),2)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(thetaS) + 4*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS)*((((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.)*(-(Cos(thetaS)*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))) + Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL))/2. - (Sqrt(3)*Sin(igdir)*(-(Cos(phiS)*Cos(thetaL)*Cos(thetaS)) - Cos(phiL)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(Cos(thetaL)*Cos(thetaS)*Sin(phiS) + Sin(phiL)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) - 2*Cos(igdir - phiS)*Sin(igdir - phiS)*Sin(thetaS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) - 2*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*((((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.)*(-(Cos(thetaS)*(Cos(phiL - phiS)*Cos(thetaS)*Sin(thetaL) - Cos(thetaL)*Sin(thetaS))) + Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL))/2. - (Sqrt(3)*Sin(igdir)*(-(Cos(phiS)*Cos(thetaL)*Cos(thetaS)) - Cos(phiL)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(Cos(thetaL)*Cos(thetaS)*Sin(phiS) + Sin(phiL)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2)))/(1 + (4*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/(Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))))*Sin(ArcTan((2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))) + (Pi*(2*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.)*(2*f0 + f1*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.)) + (K*P*(f1*P*Cos(phi0) - f1*P*Cos(phi0 + (2*Pi*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.))/P) + 2*f0*Pi*Sin(phi0) - 2*Pi*(f0 + f1*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.))*Sin(phi0 + (2*Pi*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.))/P)))/Power(Pi,2)))/2.))/(1 - Power(Cos(igdir - phiS),2)*Power(Sin(thetaS),2));
	};
	return res;
};
high_prec_t Binary::dhdthetaL(params& myParams, high_prec_t t){
	high_prec_t A0 {myParams.gravAmplitude};	
	high_prec_t AU { Constants::AU};
	high_prec_t c {Constants::C};
	high_prec_t fGW {gwFrequency(myParams,t)};
	high_prec_t thetaL { myParams.thetaL};
	high_prec_t phiL { myParams.phiL };
	high_prec_t thetaS {myParams.thetaS};
	high_prec_t phiS {myParams.phiS};
	high_prec_t psiSv { psiS(myParams, t) };
	high_prec_t omegaE {Constants::omegaE};
	high_prec_t Pi { Constants::PI };
	high_prec_t T2 { myParams.lightTwoWayTime };
	high_prec_t P { myParams.P };
	high_prec_t f0 { myParams.freqGW };
	high_prec_t f1 { myParams.f1 };
	high_prec_t K { FrequencyK(myParams) };
	high_prec_t phi0 { myParams.phiP };
	high_prec_t igdir { myParams.ig_direction };
	
	high_prec_t res;
	if (myParams.mission=="LISA") {
		res = (Sqrt(3)*Cos(ArcTan((A0*(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*((Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2)))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/2.,A0*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) + (Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))/2.)) + (Pi*(2*t*(2*f0 + f1*t) + (K*P*(f1*P*Cos(phi0) - f1*P*Cos(phi0 + (2*Pi*t)/P) + 2*f0*Pi*Sin(phi0) - 2*Pi*(f0 + f1*t)*Sin(phi0 + (2*Pi*t)/P)))/Power(Pi,2)))/2. + (2*AU*fGW*Pi*Cos(phiS - omegaE*t)*Sin(thetaS))/c)*(2*Power(A0,2)*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS))*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) + (Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))/2.,2) + (Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*(-2*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(((-0.5*(Sqrt(3)*Cos(phiL - omegaE*t)*Cos(thetaL)) - Sin(thetaL)/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS)))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. + (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaL)*Sin(phiL - phiS)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaL)*Cos(thetaS) + Cos(phiS)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaL)*Cos(thetaS)*Sin(phiL)) - Sin(phiS)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) - Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*(((-0.5*(Sqrt(3)*Cos(phiL - omegaE*t)*Cos(thetaL)) - Sin(thetaL)/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS)))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. + (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaL)*Sin(phiL - phiS)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaL)*Cos(thetaS) + Cos(phiS)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaL)*Cos(thetaS)*Sin(phiL)) - Sin(phiS)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))*((Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2)))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/2. + Power(A0,2)*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS))*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*Power((Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2)))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2) + 2*Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) + (Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))/2.)*(Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*(((-0.5*(Sqrt(3)*Cos(phiL - omegaE*t)*Cos(thetaL)) - Sin(thetaL)/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS)))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. + (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaL)*Sin(phiL - phiS)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaL)*Cos(thetaS) + Cos(phiS)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaL)*Cos(thetaS)*Sin(phiL)) - Sin(phiS)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) - 2*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(((-0.5*(Sqrt(3)*Cos(phiL - omegaE*t)*Cos(thetaL)) - Sin(thetaL)/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS)))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. + (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaL)*Sin(phiL - phiS)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaL)*Cos(thetaS) + Cos(phiS)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaL)*Cos(thetaS)*Sin(phiL)) - Sin(phiS)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))))/(4.*Sqrt(Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) + (Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))/2.,2) + (Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power((Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2)))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4.)) - (Sqrt(3)*Sqrt(Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) + (Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))/2.,2) + (Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power((Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2)))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4.)*(-((A0*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) + (Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))/2.)*((A0*(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(-2*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(((-0.5*(Sqrt(3)*Cos(phiL - omegaE*t)*Cos(thetaL)) - Sin(thetaL)/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS)))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. + (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaL)*Sin(phiL - phiS)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaL)*Cos(thetaS) + Cos(phiS)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaL)*Cos(thetaS)*Sin(phiL)) - Sin(phiS)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) - Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*(((-0.5*(Sqrt(3)*Cos(phiL - omegaE*t)*Cos(thetaL)) - Sin(thetaL)/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS)))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. + (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaL)*Sin(phiL - phiS)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaL)*Cos(thetaS) + Cos(phiS)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaL)*Cos(thetaS)*Sin(phiL)) - Sin(phiS)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/2. + A0*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS))*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*((Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2)))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))))/(Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) + (Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))/2.,2) + (Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power((Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2)))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4.)) + (A0*(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*((Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2)))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))*(A0*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) + (Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))/2.) + A0*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*(((-0.5*(Sqrt(3)*Cos(phiL - omegaE*t)*Cos(thetaL)) - Sin(thetaL)/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS)))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. + (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaL)*Sin(phiL - phiS)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaL)*Cos(thetaS) + Cos(phiS)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaL)*Cos(thetaS)*Sin(phiL)) - Sin(phiS)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) - 2*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(((-0.5*(Sqrt(3)*Cos(phiL - omegaE*t)*Cos(thetaL)) - Sin(thetaL)/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS)))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. + (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaL)*Sin(phiL - phiS)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaL)*Cos(thetaS) + Cos(phiS)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaL)*Cos(thetaS)*Sin(phiL)) - Sin(phiS)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))))/(2.*(Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) + (Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))/2.,2) + (Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power((Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2)))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4.)))*Sin(ArcTan((A0*(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*((Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2)))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/2.,A0*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) + (Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))/2.)) + (Pi*(2*t*(2*f0 + f1*t) + (K*P*(f1*P*Cos(phi0) - f1*P*Cos(phi0 + (2*Pi*t)/P) + 2*f0*Pi*Sin(phi0) - 2*Pi*(f0 + f1*t)*Sin(phi0 + (2*Pi*t)/P)))/Power(Pi,2)))/2. + (2*AU*fGW*Pi*Cos(phiS - omegaE*t)*Sin(thetaS))/c))/2.;
	} else if (myParams.mission=="IceGiant"){
		res = -0.5*(Cos(igdir - phiS)*Cos(ArcTan((2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))) + (Pi*(2*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.)*(2*f0 + f1*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.)) + (K*P*(f1*P*Cos(phi0) - f1*P*Cos(phi0 + (2*Pi*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.))/P) + 2*f0*Pi*Sin(phi0) - 2*Pi*(f0 + f1*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.))*Sin(phi0 + (2*Pi*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.))/P)))/Power(Pi,2)))/2.)*Sin(thetaS)*(Power(A0,2)*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS))*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2) + 2*Power(A0,2)*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS))*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2) + 2*Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))*(2*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*(((-0.5*(Sqrt(3)*Cos(igdir - phiL)*Cos(thetaL)) - Sin(thetaL)/2. - Cos(thetaS)*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS)))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaL)*Sin(phiL - phiS)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaL)*Cos(thetaS) + Cos(phiS)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaL)*Cos(thetaS)*Sin(phiL)) - Sin(phiS)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) + 4*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*(((-0.5*(Sqrt(3)*Cos(igdir - phiL)*Cos(thetaL)) - Sin(thetaL)/2. - Cos(thetaS)*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS)))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaL)*Sin(phiL - phiS)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaL)*Cos(thetaS) + Cos(phiS)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaL)*Cos(thetaS)*Sin(phiL)) - Sin(phiS)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))) + (Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))*(4*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS)*(((-0.5*(Sqrt(3)*Cos(igdir - phiL)*Cos(thetaL)) - Sin(thetaL)/2. - Cos(thetaS)*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS)))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaL)*Sin(phiL - phiS)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaL)*Cos(thetaS) + Cos(phiS)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaL)*Cos(thetaS)*Sin(phiL)) - Sin(phiS)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) - 2*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*(((-0.5*(Sqrt(3)*Cos(igdir - phiL)*Cos(thetaL)) - Sin(thetaL)/2. - Cos(thetaS)*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS)))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaL)*Sin(phiL - phiS)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaL)*Cos(thetaS) + Cos(phiS)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaL)*Cos(thetaS)*Sin(phiL)) - Sin(phiS)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/2.))/((1 - Power(Cos(igdir - phiS),2)*Power(Sin(thetaS),2))*Sqrt((Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4. + Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))) + (Cos(ArcTan((2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))) + (Pi*(2*t*(2*f0 + f1*t) + (K*P*(f1*P*Cos(phi0) - f1*P*Cos(phi0 + (2*Pi*t)/P) + 2*f0*Pi*Sin(phi0) - 2*Pi*(f0 + f1*t)*Sin(phi0 + (2*Pi*t)/P)))/Power(Pi,2)))/2.)*(-1 + Cos(igdir - phiS)*Sin(thetaS))*(Power(A0,2)*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS))*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2) + 2*Power(A0,2)*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS))*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2) + 2*Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))*(2*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*(((-0.5*(Sqrt(3)*Cos(igdir - phiL)*Cos(thetaL)) - Sin(thetaL)/2. - Cos(thetaS)*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS)))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaL)*Sin(phiL - phiS)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaL)*Cos(thetaS) + Cos(phiS)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaL)*Cos(thetaS)*Sin(phiL)) - Sin(phiS)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) + 4*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*(((-0.5*(Sqrt(3)*Cos(igdir - phiL)*Cos(thetaL)) - Sin(thetaL)/2. - Cos(thetaS)*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS)))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaL)*Sin(phiL - phiS)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaL)*Cos(thetaS) + Cos(phiS)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaL)*Cos(thetaS)*Sin(phiL)) - Sin(phiS)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))) + (Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))*(4*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS)*(((-0.5*(Sqrt(3)*Cos(igdir - phiL)*Cos(thetaL)) - Sin(thetaL)/2. - Cos(thetaS)*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS)))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaL)*Sin(phiL - phiS)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaL)*Cos(thetaS) + Cos(phiS)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaL)*Cos(thetaS)*Sin(phiL)) - Sin(phiS)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) - 2*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*(((-0.5*(Sqrt(3)*Cos(igdir - phiL)*Cos(thetaL)) - Sin(thetaL)/2. - Cos(thetaS)*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS)))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaL)*Sin(phiL - phiS)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaL)*Cos(thetaS) + Cos(phiS)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaL)*Cos(thetaS)*Sin(phiL)) - Sin(phiS)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/2.))/(4.*(1 - Power(Cos(igdir - phiS),2)*Power(Sin(thetaS),2))*Sqrt((Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4. + Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))) + (Cos(ArcTan((2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))) + (Pi*(2*(2*f0 + f1*(t - T2))*(t - T2) + (K*P*(f1*P*Cos(phi0) - f1*P*Cos(phi0 + (2*Pi*(t - T2))/P) + 2*f0*Pi*Sin(phi0) - 2*Pi*(f0 + f1*(t - T2))*Sin(phi0 + (2*Pi*(t - T2))/P)))/Power(Pi,2)))/2.)*(1 + Cos(igdir - phiS)*Sin(thetaS))*(Power(A0,2)*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS))*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2) + 2*Power(A0,2)*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS))*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2) + 2*Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))*(2*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*(((-0.5*(Sqrt(3)*Cos(igdir - phiL)*Cos(thetaL)) - Sin(thetaL)/2. - Cos(thetaS)*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS)))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaL)*Sin(phiL - phiS)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaL)*Cos(thetaS) + Cos(phiS)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaL)*Cos(thetaS)*Sin(phiL)) - Sin(phiS)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) + 4*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*(((-0.5*(Sqrt(3)*Cos(igdir - phiL)*Cos(thetaL)) - Sin(thetaL)/2. - Cos(thetaS)*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS)))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaL)*Sin(phiL - phiS)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaL)*Cos(thetaS) + Cos(phiS)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaL)*Cos(thetaS)*Sin(phiL)) - Sin(phiS)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))) + (Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))*(4*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS)*(((-0.5*(Sqrt(3)*Cos(igdir - phiL)*Cos(thetaL)) - Sin(thetaL)/2. - Cos(thetaS)*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS)))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaL)*Sin(phiL - phiS)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaL)*Cos(thetaS) + Cos(phiS)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaL)*Cos(thetaS)*Sin(phiL)) - Sin(phiS)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) - 2*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*(((-0.5*(Sqrt(3)*Cos(igdir - phiL)*Cos(thetaL)) - Sin(thetaL)/2. - Cos(thetaS)*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS)))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaL)*Sin(phiL - phiS)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaL)*Cos(thetaS) + Cos(phiS)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaL)*Cos(thetaS)*Sin(phiL)) - Sin(phiS)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/2.))/(4.*(1 - Power(Cos(igdir - phiS),2)*Power(Sin(thetaS),2))*Sqrt((Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4. + Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))) - ((-1 + Cos(igdir - phiS)*Sin(thetaS))*Sqrt((Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4. + Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))*((-4*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS))*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/(Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))) + (2*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))) + (2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(2*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*(((-0.5*(Sqrt(3)*Cos(igdir - phiL)*Cos(thetaL)) - Sin(thetaL)/2. - Cos(thetaS)*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS)))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaL)*Sin(phiL - phiS)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaL)*Cos(thetaS) + Cos(phiS)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaL)*Cos(thetaS)*Sin(phiL)) - Sin(phiS)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) + 4*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*(((-0.5*(Sqrt(3)*Cos(igdir - phiL)*Cos(thetaL)) - Sin(thetaL)/2. - Cos(thetaS)*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS)))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaL)*Sin(phiL - phiS)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaL)*Cos(thetaS) + Cos(phiS)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaL)*Cos(thetaS)*Sin(phiL)) - Sin(phiS)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))) - (2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))*(4*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS)*(((-0.5*(Sqrt(3)*Cos(igdir - phiL)*Cos(thetaL)) - Sin(thetaL)/2. - Cos(thetaS)*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS)))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaL)*Sin(phiL - phiS)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaL)*Cos(thetaS) + Cos(phiS)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaL)*Cos(thetaS)*Sin(phiL)) - Sin(phiS)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) - 2*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*(((-0.5*(Sqrt(3)*Cos(igdir - phiL)*Cos(thetaL)) - Sin(thetaL)/2. - Cos(thetaS)*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS)))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaL)*Sin(phiL - phiS)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaL)*Cos(thetaS) + Cos(phiS)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaL)*Cos(thetaS)*Sin(phiL)) - Sin(phiS)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2)))*Sin(ArcTan((2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))) + (Pi*(2*t*(2*f0 + f1*t) + (K*P*(f1*P*Cos(phi0) - f1*P*Cos(phi0 + (2*Pi*t)/P) + 2*f0*Pi*Sin(phi0) - 2*Pi*(f0 + f1*t)*Sin(phi0 + (2*Pi*t)/P)))/Power(Pi,2)))/2.))/(2.*(1 - Power(Cos(igdir - phiS),2)*Power(Sin(thetaS),2))*(1 + (4*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/(Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2)))) - ((1 + Cos(igdir - phiS)*Sin(thetaS))*Sqrt((Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4. + Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))*((-4*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS))*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/(Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))) + (2*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))) + (2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(2*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*(((-0.5*(Sqrt(3)*Cos(igdir - phiL)*Cos(thetaL)) - Sin(thetaL)/2. - Cos(thetaS)*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS)))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaL)*Sin(phiL - phiS)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaL)*Cos(thetaS) + Cos(phiS)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaL)*Cos(thetaS)*Sin(phiL)) - Sin(phiS)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) + 4*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*(((-0.5*(Sqrt(3)*Cos(igdir - phiL)*Cos(thetaL)) - Sin(thetaL)/2. - Cos(thetaS)*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS)))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaL)*Sin(phiL - phiS)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaL)*Cos(thetaS) + Cos(phiS)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaL)*Cos(thetaS)*Sin(phiL)) - Sin(phiS)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))) - (2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))*(4*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS)*(((-0.5*(Sqrt(3)*Cos(igdir - phiL)*Cos(thetaL)) - Sin(thetaL)/2. - Cos(thetaS)*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS)))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaL)*Sin(phiL - phiS)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaL)*Cos(thetaS) + Cos(phiS)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaL)*Cos(thetaS)*Sin(phiL)) - Sin(phiS)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) - 2*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*(((-0.5*(Sqrt(3)*Cos(igdir - phiL)*Cos(thetaL)) - Sin(thetaL)/2. - Cos(thetaS)*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS)))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaL)*Sin(phiL - phiS)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaL)*Cos(thetaS) + Cos(phiS)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaL)*Cos(thetaS)*Sin(phiL)) - Sin(phiS)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2)))*Sin(ArcTan((2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))) + (Pi*(2*(2*f0 + f1*(t - T2))*(t - T2) + (K*P*(f1*P*Cos(phi0) - f1*P*Cos(phi0 + (2*Pi*(t - T2))/P) + 2*f0*Pi*Sin(phi0) - 2*Pi*(f0 + f1*(t - T2))*Sin(phi0 + (2*Pi*(t - T2))/P)))/Power(Pi,2)))/2.))/(2.*(1 - Power(Cos(igdir - phiS),2)*Power(Sin(thetaS),2))*(1 + (4*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/(Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2)))) + (Cos(igdir - phiS)*Sin(thetaS)*Sqrt((Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4. + Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))*((-4*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS))*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/(Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))) + (2*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))) + (2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(2*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*(((-0.5*(Sqrt(3)*Cos(igdir - phiL)*Cos(thetaL)) - Sin(thetaL)/2. - Cos(thetaS)*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS)))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaL)*Sin(phiL - phiS)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaL)*Cos(thetaS) + Cos(phiS)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaL)*Cos(thetaS)*Sin(phiL)) - Sin(phiS)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) + 4*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*(((-0.5*(Sqrt(3)*Cos(igdir - phiL)*Cos(thetaL)) - Sin(thetaL)/2. - Cos(thetaS)*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS)))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaL)*Sin(phiL - phiS)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaL)*Cos(thetaS) + Cos(phiS)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaL)*Cos(thetaS)*Sin(phiL)) - Sin(phiS)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))) - (2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))*(4*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS)*(((-0.5*(Sqrt(3)*Cos(igdir - phiL)*Cos(thetaL)) - Sin(thetaL)/2. - Cos(thetaS)*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS)))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaL)*Sin(phiL - phiS)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaL)*Cos(thetaS) + Cos(phiS)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaL)*Cos(thetaS)*Sin(phiL)) - Sin(phiS)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) - 2*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*(((-0.5*(Sqrt(3)*Cos(igdir - phiL)*Cos(thetaL)) - Sin(thetaL)/2. - Cos(thetaS)*(-(Cos(thetaS)*Sin(thetaL)) + Cos(phiL - phiS)*Cos(thetaL)*Sin(thetaS)))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))*((Cos(thetaL)*Sin(phiL - phiS)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaL)*Cos(thetaS) + Cos(phiS)*Sin(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaL)*Cos(thetaS)*Sin(phiL)) - Sin(phiS)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2)))*Sin(ArcTan((2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))) + (Pi*(2*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.)*(2*f0 + f1*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.)) + (K*P*(f1*P*Cos(phi0) - f1*P*Cos(phi0 + (2*Pi*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.))/P) + 2*f0*Pi*Sin(phi0) - 2*Pi*(f0 + f1*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.))*Sin(phi0 + (2*Pi*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.))/P)))/Power(Pi,2)))/2.))/((1 - Power(Cos(igdir - phiS),2)*Power(Sin(thetaS),2))*(1 + (4*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/(Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))));
	};
	return res;
};
high_prec_t Binary::dhdphiS(params& myParams, high_prec_t t){
	high_prec_t A0 {myParams.gravAmplitude};	
	high_prec_t AU { Constants::AU};
	high_prec_t c {Constants::C};
	high_prec_t fGW {gwFrequency(myParams,t)};
	high_prec_t thetaL { myParams.thetaL};
	high_prec_t phiL { myParams.phiL };
	high_prec_t thetaS {myParams.thetaS};
	high_prec_t phiS {myParams.phiS};
	high_prec_t psiSv { psiS(myParams, t) };
	high_prec_t omegaE {Constants::omegaE};
	high_prec_t Pi { Constants::PI };
	high_prec_t T2 { myParams.lightTwoWayTime };
	high_prec_t P { myParams.P };
	high_prec_t f0 { myParams.freqGW };
	high_prec_t f1 { myParams.f1 };
	high_prec_t K { FrequencyK(myParams) };
	high_prec_t phi0 { myParams.phiP };
	high_prec_t igdir { myParams.ig_direction };
	
	high_prec_t res;
	if (myParams.mission=="LISA") {
		res = (Sqrt(3)*Cos(ArcTan((A0*(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*((Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2)))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/2.,A0*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) + (Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))/2.)) + (Pi*(2*t*(2*f0 + f1*t) + (K*P*(f1*P*Cos(phi0) - f1*P*Cos(phi0 + (2*Pi*t)/P) + 2*f0*Pi*Sin(phi0) - 2*Pi*(f0 + f1*t)*Sin(phi0 + (2*Pi*t)/P)))/Power(Pi,2)))/2. + (2*AU*fGW*Pi*Cos(phiS - omegaE*t)*Sin(thetaS))/c)*(2*Power(A0,2)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) + (Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))/2.,2) + (Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*((Sqrt(3)*Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(phiS - omegaE*t)*Sin(thetaS)*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.))/2. - Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*((2*Power(Sin(phiS - omegaE*t),2)*Power(Sin(thetaS),2))/(4*Power(Sin(phiS - omegaE*t),2)*Power(Sin(thetaS),2) + Power(Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS),2)) - (2*Cos(phiS - omegaE*t)*Sin(thetaS)*(-(Sqrt(3)*Cos(thetaS)) - Cos(phiS - omegaE*t)*Sin(thetaS)))/(4*Power(Sin(phiS - omegaE*t),2)*Power(Sin(thetaS),2) + Power(Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS),2)))*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) - 2*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*((((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.)*(-(Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)) - (Sqrt(3)*Sin(phiS - omegaE*t)*Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*(Sqrt(3)*Cos(phiS)*Cos(omegaE*t)*Cos(thetaL)*Sin(thetaS)) - (Sqrt(3)*Cos(thetaL)*Sin(phiS)*Sin(omegaE*t)*Sin(thetaS))/2. - (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. + (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) - 2*Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*((2*Power(Sin(phiS - omegaE*t),2)*Power(Sin(thetaS),2))/(4*Power(Sin(phiS - omegaE*t),2)*Power(Sin(thetaS),2) + Power(Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS),2)) - (2*Cos(phiS - omegaE*t)*Sin(thetaS)*(-(Sqrt(3)*Cos(thetaS)) - Cos(phiS - omegaE*t)*Sin(thetaS)))/(4*Power(Sin(phiS - omegaE*t),2)*Power(Sin(thetaS),2) + Power(Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) - Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*((((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.)*(-(Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)) - (Sqrt(3)*Sin(phiS - omegaE*t)*Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*(Sqrt(3)*Cos(phiS)*Cos(omegaE*t)*Cos(thetaL)*Sin(thetaS)) - (Sqrt(3)*Cos(thetaL)*Sin(phiS)*Sin(omegaE*t)*Sin(thetaS))/2. - (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. + (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) - (Sqrt(3)*Sin(phiS - omegaE*t)*Sin(thetaS)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))/2.)*((Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2)))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/2. + Power(A0,2)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*Power((Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2)))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2) + 2*Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) + (Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))/2.)*(2*Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*((2*Power(Sin(phiS - omegaE*t),2)*Power(Sin(thetaS),2))/(4*Power(Sin(phiS - omegaE*t),2)*Power(Sin(thetaS),2) + Power(Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS),2)) - (2*Cos(phiS - omegaE*t)*Sin(thetaS)*(-(Sqrt(3)*Cos(thetaS)) - Cos(phiS - omegaE*t)*Sin(thetaS)))/(4*Power(Sin(phiS - omegaE*t),2)*Power(Sin(thetaS),2) + Power(Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS),2))) + Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*((((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.)*(-(Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)) - (Sqrt(3)*Sin(phiS - omegaE*t)*Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*(Sqrt(3)*Cos(phiS)*Cos(omegaE*t)*Cos(thetaL)*Sin(thetaS)) - (Sqrt(3)*Cos(thetaL)*Sin(phiS)*Sin(omegaE*t)*Sin(thetaS))/2. - (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. + (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) + (Sqrt(3)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(phiS - omegaE*t)*Sin(thetaS)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))))/2. + (Sqrt(3)*Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(phiS - omegaE*t)*Sin(thetaS)*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))/2. - (1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*((2*Power(Sin(phiS - omegaE*t),2)*Power(Sin(thetaS),2))/(4*Power(Sin(phiS - omegaE*t),2)*Power(Sin(thetaS),2) + Power(Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS),2)) - (2*Cos(phiS - omegaE*t)*Sin(thetaS)*(-(Sqrt(3)*Cos(thetaS)) - Cos(phiS - omegaE*t)*Sin(thetaS)))/(4*Power(Sin(phiS - omegaE*t),2)*Power(Sin(thetaS),2) + Power(Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS),2)))*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) - 2*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*((((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.)*(-(Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)) - (Sqrt(3)*Sin(phiS - omegaE*t)*Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*(Sqrt(3)*Cos(phiS)*Cos(omegaE*t)*Cos(thetaL)*Sin(thetaS)) - (Sqrt(3)*Cos(thetaL)*Sin(phiS)*Sin(omegaE*t)*Sin(thetaS))/2. - (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. + (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))))/(4.*Sqrt(Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) + (Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))/2.,2) + (Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power((Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2)))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4.)) - (Sqrt(3)*Sqrt(Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) + (Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))/2.,2) + (Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power((Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2)))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4.)*((-2*AU*fGW*Pi*Sin(phiS - omegaE*t)*Sin(thetaS))/c - (A0*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) + (Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))/2.)*((A0*(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*((Sqrt(3)*Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(phiS - omegaE*t)*Sin(thetaS)*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.))/2. - Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*((2*Power(Sin(phiS - omegaE*t),2)*Power(Sin(thetaS),2))/(4*Power(Sin(phiS - omegaE*t),2)*Power(Sin(thetaS),2) + Power(Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS),2)) - (2*Cos(phiS - omegaE*t)*Sin(thetaS)*(-(Sqrt(3)*Cos(thetaS)) - Cos(phiS - omegaE*t)*Sin(thetaS)))/(4*Power(Sin(phiS - omegaE*t),2)*Power(Sin(thetaS),2) + Power(Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS),2)))*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) - 2*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*((((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.)*(-(Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)) - (Sqrt(3)*Sin(phiS - omegaE*t)*Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*(Sqrt(3)*Cos(phiS)*Cos(omegaE*t)*Cos(thetaL)*Sin(thetaS)) - (Sqrt(3)*Cos(thetaL)*Sin(phiS)*Sin(omegaE*t)*Sin(thetaS))/2. - (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. + (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) - 2*Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*((2*Power(Sin(phiS - omegaE*t),2)*Power(Sin(thetaS),2))/(4*Power(Sin(phiS - omegaE*t),2)*Power(Sin(thetaS),2) + Power(Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS),2)) - (2*Cos(phiS - omegaE*t)*Sin(thetaS)*(-(Sqrt(3)*Cos(thetaS)) - Cos(phiS - omegaE*t)*Sin(thetaS)))/(4*Power(Sin(phiS - omegaE*t),2)*Power(Sin(thetaS),2) + Power(Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) - Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*((((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.)*(-(Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)) - (Sqrt(3)*Sin(phiS - omegaE*t)*Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*(Sqrt(3)*Cos(phiS)*Cos(omegaE*t)*Cos(thetaL)*Sin(thetaS)) - (Sqrt(3)*Cos(thetaL)*Sin(phiS)*Sin(omegaE*t)*Sin(thetaS))/2. - (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. + (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) - (Sqrt(3)*Sin(phiS - omegaE*t)*Sin(thetaS)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))/2.))/2. + A0*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*((Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2)))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))))/(Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) + (Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))/2.,2) + (Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power((Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2)))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4.) + (A0*(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*((Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2)))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))*(A0*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) + (Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))/2.) + A0*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(2*Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*((2*Power(Sin(phiS - omegaE*t),2)*Power(Sin(thetaS),2))/(4*Power(Sin(phiS - omegaE*t),2)*Power(Sin(thetaS),2) + Power(Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS),2)) - (2*Cos(phiS - omegaE*t)*Sin(thetaS)*(-(Sqrt(3)*Cos(thetaS)) - Cos(phiS - omegaE*t)*Sin(thetaS)))/(4*Power(Sin(phiS - omegaE*t),2)*Power(Sin(thetaS),2) + Power(Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS),2))) + Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*((((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.)*(-(Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)) - (Sqrt(3)*Sin(phiS - omegaE*t)*Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*(Sqrt(3)*Cos(phiS)*Cos(omegaE*t)*Cos(thetaL)*Sin(thetaS)) - (Sqrt(3)*Cos(thetaL)*Sin(phiS)*Sin(omegaE*t)*Sin(thetaS))/2. - (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. + (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) + (Sqrt(3)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(phiS - omegaE*t)*Sin(thetaS)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))))/2. + (Sqrt(3)*Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(phiS - omegaE*t)*Sin(thetaS)*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))/2. - (1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*((2*Power(Sin(phiS - omegaE*t),2)*Power(Sin(thetaS),2))/(4*Power(Sin(phiS - omegaE*t),2)*Power(Sin(thetaS),2) + Power(Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS),2)) - (2*Cos(phiS - omegaE*t)*Sin(thetaS)*(-(Sqrt(3)*Cos(thetaS)) - Cos(phiS - omegaE*t)*Sin(thetaS)))/(4*Power(Sin(phiS - omegaE*t),2)*Power(Sin(thetaS),2) + Power(Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS),2)))*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) - 2*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*((((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.)*(-(Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)) - (Sqrt(3)*Sin(phiS - omegaE*t)*Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + ((-0.5*(Sqrt(3)*Cos(phiS)*Cos(omegaE*t)*Cos(thetaL)*Sin(thetaS)) - (Sqrt(3)*Cos(thetaL)*Sin(phiS)*Sin(omegaE*t)*Sin(thetaS))/2. - (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. + (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))))/(2.*(Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) + (Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))/2.,2) + (Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power((Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2)))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4.)))*Sin(ArcTan((A0*(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*((Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2)))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/2.,A0*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) + (Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))/2.)) + (Pi*(2*t*(2*f0 + f1*t) + (K*P*(f1*P*Cos(phi0) - f1*P*Cos(phi0 + (2*Pi*t)/P) + 2*f0*Pi*Sin(phi0) - 2*Pi*(f0 + f1*t)*Sin(phi0 + (2*Pi*t)/P)))/Power(Pi,2)))/2. + (2*AU*fGW*Pi*Cos(phiS - omegaE*t)*Sin(thetaS))/c))/2.;
	} else if (myParams.mission=="IceGiant"){
		res = (-2*Power(Cos(igdir - phiS),2)*Cos(ArcTan((2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))) + (Pi*(2*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.)*(2*f0 + f1*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.)) + (K*P*(f1*P*Cos(phi0) - f1*P*Cos(phi0 + (2*Pi*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.))/P) + 2*f0*Pi*Sin(phi0) - 2*Pi*(f0 + f1*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.))*Sin(phi0 + (2*Pi*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.))/P)))/Power(Pi,2)))/2.)*Sin(igdir - phiS)*Power(Sin(thetaS),3)*Sqrt((Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4. + Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2)))/Power(1 - Power(Cos(igdir - phiS),2)*Power(Sin(thetaS),2),2) + (Cos(igdir - phiS)*Cos(ArcTan((2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))) + (Pi*(2*t*(2*f0 + f1*t) + (K*P*(f1*P*Cos(phi0) - f1*P*Cos(phi0 + (2*Pi*t)/P) + 2*f0*Pi*Sin(phi0) - 2*Pi*(f0 + f1*t)*Sin(phi0 + (2*Pi*t)/P)))/Power(Pi,2)))/2.)*Sin(igdir - phiS)*Power(Sin(thetaS),2)*(-1 + Cos(igdir - phiS)*Sin(thetaS))*Sqrt((Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4. + Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2)))/Power(1 - Power(Cos(igdir - phiS),2)*Power(Sin(thetaS),2),2) + (Cos(igdir - phiS)*Cos(ArcTan((2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))) + (Pi*(2*(2*f0 + f1*(t - T2))*(t - T2) + (K*P*(f1*P*Cos(phi0) - f1*P*Cos(phi0 + (2*Pi*(t - T2))/P) + 2*f0*Pi*Sin(phi0) - 2*Pi*(f0 + f1*(t - T2))*Sin(phi0 + (2*Pi*(t - T2))/P)))/Power(Pi,2)))/2.)*Sin(igdir - phiS)*Power(Sin(thetaS),2)*(1 + Cos(igdir - phiS)*Sin(thetaS))*Sqrt((Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4. + Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2)))/Power(1 - Power(Cos(igdir - phiS),2)*Power(Sin(thetaS),2),2) + (Cos(ArcTan((2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))) + (Pi*(2*t*(2*f0 + f1*t) + (K*P*(f1*P*Cos(phi0) - f1*P*Cos(phi0 + (2*Pi*t)/P) + 2*f0*Pi*Sin(phi0) - 2*Pi*(f0 + f1*t)*Sin(phi0 + (2*Pi*t)/P)))/Power(Pi,2)))/2.)*Sin(igdir - phiS)*Sin(thetaS)*Sqrt((Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4. + Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2)))/(2.*(1 - Power(Cos(igdir - phiS),2)*Power(Sin(thetaS),2))) + (Cos(ArcTan((2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))) + (Pi*(2*(2*f0 + f1*(t - T2))*(t - T2) + (K*P*(f1*P*Cos(phi0) - f1*P*Cos(phi0 + (2*Pi*(t - T2))/P) + 2*f0*Pi*Sin(phi0) - 2*Pi*(f0 + f1*(t - T2))*Sin(phi0 + (2*Pi*(t - T2))/P)))/Power(Pi,2)))/2.)*Sin(igdir - phiS)*Sin(thetaS)*Sqrt((Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4. + Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2)))/(2.*(1 - Power(Cos(igdir - phiS),2)*Power(Sin(thetaS),2))) - (Cos(ArcTan((2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))) + (Pi*(2*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.)*(2*f0 + f1*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.)) + (K*P*(f1*P*Cos(phi0) - f1*P*Cos(phi0 + (2*Pi*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.))/P) + 2*f0*Pi*Sin(phi0) - 2*Pi*(f0 + f1*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.))*Sin(phi0 + (2*Pi*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.))/P)))/Power(Pi,2)))/2.)*Sin(igdir - phiS)*Sin(thetaS)*Sqrt((Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4. + Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2)))/(1 - Power(Cos(igdir - phiS),2)*Power(Sin(thetaS),2)) - (Cos(igdir - phiS)*Cos(ArcTan((2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))) + (Pi*(2*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.)*(2*f0 + f1*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.)) + (K*P*(f1*P*Cos(phi0) - f1*P*Cos(phi0 + (2*Pi*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.))/P) + 2*f0*Pi*Sin(phi0) - 2*Pi*(f0 + f1*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.))*Sin(phi0 + (2*Pi*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.))/P)))/Power(Pi,2)))/2.)*Sin(thetaS)*(Power(A0,2)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2) + 2*Power(A0,2)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2) + 2*Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))*(2*Power(Cos(igdir - phiS),2)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) - 2*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Power(Sin(igdir - phiS),2) + 2*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*(-((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) + ((-0.5*(Sqrt(3)*Cos(igdir)*Cos(phiS)*Cos(thetaL)*Sin(thetaS)) - (Sqrt(3)*Cos(thetaL)*Sin(igdir)*Sin(phiS)*Sin(thetaS))/2. - (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) + (2*Cos(igdir - phiS)*Sin(igdir - phiS) + 2*Cos(igdir - phiS)*Power(Cos(thetaS),2)*Sin(igdir - phiS))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) + 4*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*(-((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) + ((-0.5*(Sqrt(3)*Cos(igdir)*Cos(phiS)*Cos(thetaL)*Sin(thetaS)) - (Sqrt(3)*Cos(thetaL)*Sin(igdir)*Sin(phiS)*Sin(thetaS))/2. - (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))) + (Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(2*Cos(igdir - phiS)*Sin(igdir - phiS) + 2*Cos(igdir - phiS)*Power(Cos(thetaS),2)*Sin(igdir - phiS)) + 4*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS)*(-((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) + ((-0.5*(Sqrt(3)*Cos(igdir)*Cos(phiS)*Cos(thetaL)*Sin(thetaS)) - (Sqrt(3)*Cos(thetaL)*Sin(igdir)*Sin(phiS)*Sin(thetaS))/2. - (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) - 2*Power(Cos(igdir - phiS),2)*Cos(thetaS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) + 2*Cos(thetaS)*Power(Sin(igdir - phiS),2)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) - 2*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*(-((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) + ((-0.5*(Sqrt(3)*Cos(igdir)*Cos(phiS)*Cos(thetaL)*Sin(thetaS)) - (Sqrt(3)*Cos(thetaL)*Sin(igdir)*Sin(phiS)*Sin(thetaS))/2. - (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/2.))/(2.*(1 - Power(Cos(igdir - phiS),2)*Power(Sin(thetaS),2))*Sqrt((Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4. + Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))) + (Cos(ArcTan((2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))) + (Pi*(2*t*(2*f0 + f1*t) + (K*P*(f1*P*Cos(phi0) - f1*P*Cos(phi0 + (2*Pi*t)/P) + 2*f0*Pi*Sin(phi0) - 2*Pi*(f0 + f1*t)*Sin(phi0 + (2*Pi*t)/P)))/Power(Pi,2)))/2.)*(-1 + Cos(igdir - phiS)*Sin(thetaS))*(Power(A0,2)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2) + 2*Power(A0,2)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2) + 2*Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))*(2*Power(Cos(igdir - phiS),2)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) - 2*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Power(Sin(igdir - phiS),2) + 2*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*(-((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) + ((-0.5*(Sqrt(3)*Cos(igdir)*Cos(phiS)*Cos(thetaL)*Sin(thetaS)) - (Sqrt(3)*Cos(thetaL)*Sin(igdir)*Sin(phiS)*Sin(thetaS))/2. - (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) + (2*Cos(igdir - phiS)*Sin(igdir - phiS) + 2*Cos(igdir - phiS)*Power(Cos(thetaS),2)*Sin(igdir - phiS))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) + 4*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*(-((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) + ((-0.5*(Sqrt(3)*Cos(igdir)*Cos(phiS)*Cos(thetaL)*Sin(thetaS)) - (Sqrt(3)*Cos(thetaL)*Sin(igdir)*Sin(phiS)*Sin(thetaS))/2. - (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))) + (Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(2*Cos(igdir - phiS)*Sin(igdir - phiS) + 2*Cos(igdir - phiS)*Power(Cos(thetaS),2)*Sin(igdir - phiS)) + 4*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS)*(-((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) + ((-0.5*(Sqrt(3)*Cos(igdir)*Cos(phiS)*Cos(thetaL)*Sin(thetaS)) - (Sqrt(3)*Cos(thetaL)*Sin(igdir)*Sin(phiS)*Sin(thetaS))/2. - (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) - 2*Power(Cos(igdir - phiS),2)*Cos(thetaS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) + 2*Cos(thetaS)*Power(Sin(igdir - phiS),2)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) - 2*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*(-((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) + ((-0.5*(Sqrt(3)*Cos(igdir)*Cos(phiS)*Cos(thetaL)*Sin(thetaS)) - (Sqrt(3)*Cos(thetaL)*Sin(igdir)*Sin(phiS)*Sin(thetaS))/2. - (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/2.))/(4.*(1 - Power(Cos(igdir - phiS),2)*Power(Sin(thetaS),2))*Sqrt((Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4. + Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))) + (Cos(ArcTan((2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))) + (Pi*(2*(2*f0 + f1*(t - T2))*(t - T2) + (K*P*(f1*P*Cos(phi0) - f1*P*Cos(phi0 + (2*Pi*(t - T2))/P) + 2*f0*Pi*Sin(phi0) - 2*Pi*(f0 + f1*(t - T2))*Sin(phi0 + (2*Pi*(t - T2))/P)))/Power(Pi,2)))/2.)*(1 + Cos(igdir - phiS)*Sin(thetaS))*(Power(A0,2)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2) + 2*Power(A0,2)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2) + 2*Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))*(2*Power(Cos(igdir - phiS),2)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) - 2*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Power(Sin(igdir - phiS),2) + 2*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*(-((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) + ((-0.5*(Sqrt(3)*Cos(igdir)*Cos(phiS)*Cos(thetaL)*Sin(thetaS)) - (Sqrt(3)*Cos(thetaL)*Sin(igdir)*Sin(phiS)*Sin(thetaS))/2. - (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) + (2*Cos(igdir - phiS)*Sin(igdir - phiS) + 2*Cos(igdir - phiS)*Power(Cos(thetaS),2)*Sin(igdir - phiS))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) + 4*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*(-((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) + ((-0.5*(Sqrt(3)*Cos(igdir)*Cos(phiS)*Cos(thetaL)*Sin(thetaS)) - (Sqrt(3)*Cos(thetaL)*Sin(igdir)*Sin(phiS)*Sin(thetaS))/2. - (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))) + (Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(2*Cos(igdir - phiS)*Sin(igdir - phiS) + 2*Cos(igdir - phiS)*Power(Cos(thetaS),2)*Sin(igdir - phiS)) + 4*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS)*(-((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) + ((-0.5*(Sqrt(3)*Cos(igdir)*Cos(phiS)*Cos(thetaL)*Sin(thetaS)) - (Sqrt(3)*Cos(thetaL)*Sin(igdir)*Sin(phiS)*Sin(thetaS))/2. - (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) - 2*Power(Cos(igdir - phiS),2)*Cos(thetaS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) + 2*Cos(thetaS)*Power(Sin(igdir - phiS),2)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) - 2*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*(-((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) + ((-0.5*(Sqrt(3)*Cos(igdir)*Cos(phiS)*Cos(thetaL)*Sin(thetaS)) - (Sqrt(3)*Cos(thetaL)*Sin(igdir)*Sin(phiS)*Sin(thetaS))/2. - (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/2.))/(4.*(1 - Power(Cos(igdir - phiS),2)*Power(Sin(thetaS),2))*Sqrt((Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4. + Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))) - ((-1 + Cos(igdir - phiS)*Sin(thetaS))*Sqrt((Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4. + Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))*((-4*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/(Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))) + (2*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))) + (2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(2*Power(Cos(igdir - phiS),2)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) - 2*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Power(Sin(igdir - phiS),2) + 2*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*(-((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) + ((-0.5*(Sqrt(3)*Cos(igdir)*Cos(phiS)*Cos(thetaL)*Sin(thetaS)) - (Sqrt(3)*Cos(thetaL)*Sin(igdir)*Sin(phiS)*Sin(thetaS))/2. - (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) + (2*Cos(igdir - phiS)*Sin(igdir - phiS) + 2*Cos(igdir - phiS)*Power(Cos(thetaS),2)*Sin(igdir - phiS))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) + 4*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*(-((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) + ((-0.5*(Sqrt(3)*Cos(igdir)*Cos(phiS)*Cos(thetaL)*Sin(thetaS)) - (Sqrt(3)*Cos(thetaL)*Sin(igdir)*Sin(phiS)*Sin(thetaS))/2. - (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))) - (2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(2*Cos(igdir - phiS)*Sin(igdir - phiS) + 2*Cos(igdir - phiS)*Power(Cos(thetaS),2)*Sin(igdir - phiS)) + 4*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS)*(-((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) + ((-0.5*(Sqrt(3)*Cos(igdir)*Cos(phiS)*Cos(thetaL)*Sin(thetaS)) - (Sqrt(3)*Cos(thetaL)*Sin(igdir)*Sin(phiS)*Sin(thetaS))/2. - (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) - 2*Power(Cos(igdir - phiS),2)*Cos(thetaS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) + 2*Cos(thetaS)*Power(Sin(igdir - phiS),2)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) - 2*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*(-((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) + ((-0.5*(Sqrt(3)*Cos(igdir)*Cos(phiS)*Cos(thetaL)*Sin(thetaS)) - (Sqrt(3)*Cos(thetaL)*Sin(igdir)*Sin(phiS)*Sin(thetaS))/2. - (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2)))*Sin(ArcTan((2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))) + (Pi*(2*t*(2*f0 + f1*t) + (K*P*(f1*P*Cos(phi0) - f1*P*Cos(phi0 + (2*Pi*t)/P) + 2*f0*Pi*Sin(phi0) - 2*Pi*(f0 + f1*t)*Sin(phi0 + (2*Pi*t)/P)))/Power(Pi,2)))/2.))/(2.*(1 - Power(Cos(igdir - phiS),2)*Power(Sin(thetaS),2))*(1 + (4*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/(Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2)))) - ((1 + Cos(igdir - phiS)*Sin(thetaS))*Sqrt((Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4. + Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))*((-4*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/(Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))) + (2*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))) + (2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(2*Power(Cos(igdir - phiS),2)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) - 2*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Power(Sin(igdir - phiS),2) + 2*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*(-((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) + ((-0.5*(Sqrt(3)*Cos(igdir)*Cos(phiS)*Cos(thetaL)*Sin(thetaS)) - (Sqrt(3)*Cos(thetaL)*Sin(igdir)*Sin(phiS)*Sin(thetaS))/2. - (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) + (2*Cos(igdir - phiS)*Sin(igdir - phiS) + 2*Cos(igdir - phiS)*Power(Cos(thetaS),2)*Sin(igdir - phiS))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) + 4*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*(-((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) + ((-0.5*(Sqrt(3)*Cos(igdir)*Cos(phiS)*Cos(thetaL)*Sin(thetaS)) - (Sqrt(3)*Cos(thetaL)*Sin(igdir)*Sin(phiS)*Sin(thetaS))/2. - (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))) - (2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(2*Cos(igdir - phiS)*Sin(igdir - phiS) + 2*Cos(igdir - phiS)*Power(Cos(thetaS),2)*Sin(igdir - phiS)) + 4*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS)*(-((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) + ((-0.5*(Sqrt(3)*Cos(igdir)*Cos(phiS)*Cos(thetaL)*Sin(thetaS)) - (Sqrt(3)*Cos(thetaL)*Sin(igdir)*Sin(phiS)*Sin(thetaS))/2. - (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) - 2*Power(Cos(igdir - phiS),2)*Cos(thetaS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) + 2*Cos(thetaS)*Power(Sin(igdir - phiS),2)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) - 2*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*(-((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) + ((-0.5*(Sqrt(3)*Cos(igdir)*Cos(phiS)*Cos(thetaL)*Sin(thetaS)) - (Sqrt(3)*Cos(thetaL)*Sin(igdir)*Sin(phiS)*Sin(thetaS))/2. - (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2)))*Sin(ArcTan((2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))) + (Pi*(2*(2*f0 + f1*(t - T2))*(t - T2) + (K*P*(f1*P*Cos(phi0) - f1*P*Cos(phi0 + (2*Pi*(t - T2))/P) + 2*f0*Pi*Sin(phi0) - 2*Pi*(f0 + f1*(t - T2))*Sin(phi0 + (2*Pi*(t - T2))/P)))/Power(Pi,2)))/2.))/(2.*(1 - Power(Cos(igdir - phiS),2)*Power(Sin(thetaS),2))*(1 + (4*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/(Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2)))) + (Cos(igdir - phiS)*Sin(thetaS)*Sqrt((Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4. + Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))*((Pi*(-(f1*T2*Sin(igdir - phiS)*Sin(thetaS)*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.)) + 2*K*T2*Cos(phi0 + (2*Pi*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.))/P)*Sin(igdir - phiS)*Sin(thetaS)*(f0 + f1*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.)) - T2*Sin(igdir - phiS)*Sin(thetaS)*(2*f0 + f1*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.))))/2. + ((-4*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/(Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))) + (2*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))) + (2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(2*Power(Cos(igdir - phiS),2)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) - 2*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Power(Sin(igdir - phiS),2) + 2*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*(-((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) + ((-0.5*(Sqrt(3)*Cos(igdir)*Cos(phiS)*Cos(thetaL)*Sin(thetaS)) - (Sqrt(3)*Cos(thetaL)*Sin(igdir)*Sin(phiS)*Sin(thetaS))/2. - (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) + (2*Cos(igdir - phiS)*Sin(igdir - phiS) + 2*Cos(igdir - phiS)*Power(Cos(thetaS),2)*Sin(igdir - phiS))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) + 4*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*(-((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) + ((-0.5*(Sqrt(3)*Cos(igdir)*Cos(phiS)*Cos(thetaL)*Sin(thetaS)) - (Sqrt(3)*Cos(thetaL)*Sin(igdir)*Sin(phiS)*Sin(thetaS))/2. - (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))) - (2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(2*Cos(igdir - phiS)*Sin(igdir - phiS) + 2*Cos(igdir - phiS)*Power(Cos(thetaS),2)*Sin(igdir - phiS)) + 4*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS)*(-((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) + ((-0.5*(Sqrt(3)*Cos(igdir)*Cos(phiS)*Cos(thetaL)*Sin(thetaS)) - (Sqrt(3)*Cos(thetaL)*Sin(igdir)*Sin(phiS)*Sin(thetaS))/2. - (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) - 2*Power(Cos(igdir - phiS),2)*Cos(thetaS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) + 2*Cos(thetaS)*Power(Sin(igdir - phiS),2)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))) - 2*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*(-((Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) + ((-0.5*(Sqrt(3)*Cos(igdir)*Cos(phiS)*Cos(thetaL)*Sin(thetaS)) - (Sqrt(3)*Cos(thetaL)*Sin(igdir)*Sin(phiS)*Sin(thetaS))/2. - (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2)))/(1 + (4*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/(Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))))*Sin(ArcTan((2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))) + (Pi*(2*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.)*(2*f0 + f1*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.)) + (K*P*(f1*P*Cos(phi0) - f1*P*Cos(phi0 + (2*Pi*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.))/P) + 2*f0*Pi*Sin(phi0) - 2*Pi*(f0 + f1*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.))*Sin(phi0 + (2*Pi*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.))/P)))/Power(Pi,2)))/2.))/(1 - Power(Cos(igdir - phiS),2)*Power(Sin(thetaS),2));
	};
	return res;
};
high_prec_t Binary::dhdphiL(params& myParams, high_prec_t t){
	high_prec_t A0 {myParams.gravAmplitude};	
	high_prec_t AU { Constants::AU};
	high_prec_t c {Constants::C};
	high_prec_t fGW {gwFrequency(myParams,t)};
	high_prec_t thetaL { myParams.thetaL};
	high_prec_t phiL { myParams.phiL };
	high_prec_t thetaS {myParams.thetaS};
	high_prec_t phiS {myParams.phiS};
	high_prec_t psiSv { psiS(myParams, t) };
	high_prec_t omegaE {Constants::omegaE};
	high_prec_t Pi { Constants::PI };
	high_prec_t T2 { myParams.lightTwoWayTime };
	high_prec_t P { myParams.P };
	high_prec_t f0 { myParams.freqGW };
	high_prec_t f1 { myParams.f1 };
	high_prec_t K { FrequencyK(myParams) };
	high_prec_t phi0 { myParams.phiP };
	high_prec_t igdir { myParams.ig_direction };
	
	high_prec_t res;
	if (myParams.mission=="LISA") {
		res = (Sqrt(3)*Cos(ArcTan((A0*(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*((Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2)))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/2.,A0*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) + (Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))/2.)) + (Pi*(2*t*(2*f0 + f1*t) + (K*P*(f1*P*Cos(phi0) - f1*P*Cos(phi0 + (2*Pi*t)/P) + 2*f0*Pi*Sin(phi0) - 2*Pi*(f0 + f1*t)*Sin(phi0 + (2*Pi*t)/P)))/Power(Pi,2)))/2. + (2*AU*fGW*Pi*Cos(phiS - omegaE*t)*Sin(thetaS))/c)*(-2*Power(A0,2)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) + (Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))/2.,2) + (Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*(-2*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*((((Sqrt(3)*Sin(phiL - omegaE*t)*Sin(thetaL))/2. + Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + (((Sqrt(3)*Cos(phiL)*Cos(omegaE*t)*Cos(thetaS)*Sin(thetaL))/2. + (Sqrt(3)*Cos(thetaS)*Sin(phiL)*Sin(omegaE*t)*Sin(thetaL))/2. + (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. + (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) - Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*((((Sqrt(3)*Sin(phiL - omegaE*t)*Sin(thetaL))/2. + Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + (((Sqrt(3)*Cos(phiL)*Cos(omegaE*t)*Cos(thetaS)*Sin(thetaL))/2. + (Sqrt(3)*Cos(thetaS)*Sin(phiL)*Sin(omegaE*t)*Sin(thetaL))/2. + (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. + (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))*((Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2)))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/2. - Power(A0,2)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*Power((Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2)))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2) + 2*Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) + (Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))/2.)*(Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*((((Sqrt(3)*Sin(phiL - omegaE*t)*Sin(thetaL))/2. + Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + (((Sqrt(3)*Cos(phiL)*Cos(omegaE*t)*Cos(thetaS)*Sin(thetaL))/2. + (Sqrt(3)*Cos(thetaS)*Sin(phiL)*Sin(omegaE*t)*Sin(thetaL))/2. + (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. + (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) - 2*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*((((Sqrt(3)*Sin(phiL - omegaE*t)*Sin(thetaL))/2. + Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + (((Sqrt(3)*Cos(phiL)*Cos(omegaE*t)*Cos(thetaS)*Sin(thetaL))/2. + (Sqrt(3)*Cos(thetaS)*Sin(phiL)*Sin(omegaE*t)*Sin(thetaL))/2. + (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. + (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))))/(4.*Sqrt(Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) + (Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))/2.,2) + (Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power((Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2)))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4.)) - (Sqrt(3)*Sqrt(Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) + (Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))/2.,2) + (Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power((Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2)))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4.)*(-((A0*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) + (Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))/2.)*((A0*(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(-2*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*((((Sqrt(3)*Sin(phiL - omegaE*t)*Sin(thetaL))/2. + Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + (((Sqrt(3)*Cos(phiL)*Cos(omegaE*t)*Cos(thetaS)*Sin(thetaL))/2. + (Sqrt(3)*Cos(thetaS)*Sin(phiL)*Sin(omegaE*t)*Sin(thetaL))/2. + (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. + (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) - Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*((((Sqrt(3)*Sin(phiL - omegaE*t)*Sin(thetaL))/2. + Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + (((Sqrt(3)*Cos(phiL)*Cos(omegaE*t)*Cos(thetaS)*Sin(thetaL))/2. + (Sqrt(3)*Cos(thetaS)*Sin(phiL)*Sin(omegaE*t)*Sin(thetaL))/2. + (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. + (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/2. - A0*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*((Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2)))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))))/(Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) + (Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))/2.,2) + (Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power((Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2)))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4.)) + (A0*(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*((Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2)))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))*(-(A0*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) + (Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))/2.)) + A0*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*((((Sqrt(3)*Sin(phiL - omegaE*t)*Sin(thetaL))/2. + Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + (((Sqrt(3)*Cos(phiL)*Cos(omegaE*t)*Cos(thetaS)*Sin(thetaL))/2. + (Sqrt(3)*Cos(thetaS)*Sin(phiL)*Sin(omegaE*t)*Sin(thetaL))/2. + (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. + (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) - 2*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*((((Sqrt(3)*Sin(phiL - omegaE*t)*Sin(thetaL))/2. + Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + (((Sqrt(3)*Cos(phiL)*Cos(omegaE*t)*Cos(thetaS)*Sin(thetaL))/2. + (Sqrt(3)*Cos(thetaS)*Sin(phiL)*Sin(omegaE*t)*Sin(thetaL))/2. + (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. + (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))))/(2.*(Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) + (Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))/2.,2) + (Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power((Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2)))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4.)))*Sin(ArcTan((A0*(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*((Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2)))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/2.,A0*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*Sin(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS)))) + (Cos(2*(omegaE*t + ArcTan(-2*Sin(phiS - omegaE*t)*Sin(thetaS),Sqrt(3)*Cos(thetaS) + Cos(phiS - omegaE*t)*Sin(thetaS))))*(1 + Power(Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.,2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(omegaE*t)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(omegaE*t)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(phiL - omegaE*t)*Sin(thetaL))/2. - (Cos(thetaS)/2. - (Sqrt(3)*Cos(phiS - omegaE*t)*Sin(thetaS))/2.)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))/2.)) + (Pi*(2*t*(2*f0 + f1*t) + (K*P*(f1*P*Cos(phi0) - f1*P*Cos(phi0 + (2*Pi*t)/P) + 2*f0*Pi*Sin(phi0) - 2*Pi*(f0 + f1*t)*Sin(phi0 + (2*Pi*t)/P)))/Power(Pi,2)))/2. + (2*AU*fGW*Pi*Cos(phiS - omegaE*t)*Sin(thetaS))/c))/2.;
	} else if (myParams.mission=="IceGiant"){
		res = -0.5*(Cos(igdir - phiS)*Cos(ArcTan((2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))) + (Pi*(2*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.)*(2*f0 + f1*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.)) + (K*P*(f1*P*Cos(phi0) - f1*P*Cos(phi0 + (2*Pi*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.))/P) + 2*f0*Pi*Sin(phi0) - 2*Pi*(f0 + f1*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.))*Sin(phi0 + (2*Pi*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.))/P)))/Power(Pi,2)))/2.)*Sin(thetaS)*(-(Power(A0,2)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2)) - 2*Power(A0,2)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2) + 2*Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))*(2*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*(((-0.5*(Sqrt(3)*Sin(igdir - phiL)*Sin(thetaL)) + Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + (((Sqrt(3)*Cos(igdir)*Cos(phiL)*Cos(thetaS)*Sin(thetaL))/2. + (Sqrt(3)*Cos(thetaS)*Sin(igdir)*Sin(phiL)*Sin(thetaL))/2. + (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) + 4*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*(((-0.5*(Sqrt(3)*Sin(igdir - phiL)*Sin(thetaL)) + Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + (((Sqrt(3)*Cos(igdir)*Cos(phiL)*Cos(thetaS)*Sin(thetaL))/2. + (Sqrt(3)*Cos(thetaS)*Sin(igdir)*Sin(phiL)*Sin(thetaL))/2. + (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))) + (Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))*(4*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS)*(((-0.5*(Sqrt(3)*Sin(igdir - phiL)*Sin(thetaL)) + Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + (((Sqrt(3)*Cos(igdir)*Cos(phiL)*Cos(thetaS)*Sin(thetaL))/2. + (Sqrt(3)*Cos(thetaS)*Sin(igdir)*Sin(phiL)*Sin(thetaL))/2. + (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) - 2*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*(((-0.5*(Sqrt(3)*Sin(igdir - phiL)*Sin(thetaL)) + Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + (((Sqrt(3)*Cos(igdir)*Cos(phiL)*Cos(thetaS)*Sin(thetaL))/2. + (Sqrt(3)*Cos(thetaS)*Sin(igdir)*Sin(phiL)*Sin(thetaL))/2. + (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/2.))/((1 - Power(Cos(igdir - phiS),2)*Power(Sin(thetaS),2))*Sqrt((Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4. + Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))) + (Cos(ArcTan((2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))) + (Pi*(2*t*(2*f0 + f1*t) + (K*P*(f1*P*Cos(phi0) - f1*P*Cos(phi0 + (2*Pi*t)/P) + 2*f0*Pi*Sin(phi0) - 2*Pi*(f0 + f1*t)*Sin(phi0 + (2*Pi*t)/P)))/Power(Pi,2)))/2.)*(-1 + Cos(igdir - phiS)*Sin(thetaS))*(-(Power(A0,2)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2)) - 2*Power(A0,2)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2) + 2*Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))*(2*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*(((-0.5*(Sqrt(3)*Sin(igdir - phiL)*Sin(thetaL)) + Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + (((Sqrt(3)*Cos(igdir)*Cos(phiL)*Cos(thetaS)*Sin(thetaL))/2. + (Sqrt(3)*Cos(thetaS)*Sin(igdir)*Sin(phiL)*Sin(thetaL))/2. + (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) + 4*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*(((-0.5*(Sqrt(3)*Sin(igdir - phiL)*Sin(thetaL)) + Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + (((Sqrt(3)*Cos(igdir)*Cos(phiL)*Cos(thetaS)*Sin(thetaL))/2. + (Sqrt(3)*Cos(thetaS)*Sin(igdir)*Sin(phiL)*Sin(thetaL))/2. + (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))) + (Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))*(4*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS)*(((-0.5*(Sqrt(3)*Sin(igdir - phiL)*Sin(thetaL)) + Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + (((Sqrt(3)*Cos(igdir)*Cos(phiL)*Cos(thetaS)*Sin(thetaL))/2. + (Sqrt(3)*Cos(thetaS)*Sin(igdir)*Sin(phiL)*Sin(thetaL))/2. + (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) - 2*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*(((-0.5*(Sqrt(3)*Sin(igdir - phiL)*Sin(thetaL)) + Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + (((Sqrt(3)*Cos(igdir)*Cos(phiL)*Cos(thetaS)*Sin(thetaL))/2. + (Sqrt(3)*Cos(thetaS)*Sin(igdir)*Sin(phiL)*Sin(thetaL))/2. + (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/2.))/(4.*(1 - Power(Cos(igdir - phiS),2)*Power(Sin(thetaS),2))*Sqrt((Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4. + Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))) + (Cos(ArcTan((2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))) + (Pi*(2*(2*f0 + f1*(t - T2))*(t - T2) + (K*P*(f1*P*Cos(phi0) - f1*P*Cos(phi0 + (2*Pi*(t - T2))/P) + 2*f0*Pi*Sin(phi0) - 2*Pi*(f0 + f1*(t - T2))*Sin(phi0 + (2*Pi*(t - T2))/P)))/Power(Pi,2)))/2.)*(1 + Cos(igdir - phiS)*Sin(thetaS))*(-(Power(A0,2)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2)) - 2*Power(A0,2)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2) + 2*Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))*(2*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*(((-0.5*(Sqrt(3)*Sin(igdir - phiL)*Sin(thetaL)) + Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + (((Sqrt(3)*Cos(igdir)*Cos(phiL)*Cos(thetaS)*Sin(thetaL))/2. + (Sqrt(3)*Cos(thetaS)*Sin(igdir)*Sin(phiL)*Sin(thetaL))/2. + (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) + 4*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*(((-0.5*(Sqrt(3)*Sin(igdir - phiL)*Sin(thetaL)) + Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + (((Sqrt(3)*Cos(igdir)*Cos(phiL)*Cos(thetaS)*Sin(thetaL))/2. + (Sqrt(3)*Cos(thetaS)*Sin(igdir)*Sin(phiL)*Sin(thetaL))/2. + (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))) + (Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))*(4*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS)*(((-0.5*(Sqrt(3)*Sin(igdir - phiL)*Sin(thetaL)) + Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + (((Sqrt(3)*Cos(igdir)*Cos(phiL)*Cos(thetaS)*Sin(thetaL))/2. + (Sqrt(3)*Cos(thetaS)*Sin(igdir)*Sin(phiL)*Sin(thetaL))/2. + (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) - 2*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*(((-0.5*(Sqrt(3)*Sin(igdir - phiL)*Sin(thetaL)) + Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + (((Sqrt(3)*Cos(igdir)*Cos(phiL)*Cos(thetaS)*Sin(thetaL))/2. + (Sqrt(3)*Cos(thetaS)*Sin(igdir)*Sin(phiL)*Sin(thetaL))/2. + (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/2.))/(4.*(1 - Power(Cos(igdir - phiS),2)*Power(Sin(thetaS),2))*Sqrt((Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4. + Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))) - ((-1 + Cos(igdir - phiS)*Sin(thetaS))*Sqrt((Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4. + Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))*((4*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/(Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))) - (2*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))) + (2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(2*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*(((-0.5*(Sqrt(3)*Sin(igdir - phiL)*Sin(thetaL)) + Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + (((Sqrt(3)*Cos(igdir)*Cos(phiL)*Cos(thetaS)*Sin(thetaL))/2. + (Sqrt(3)*Cos(thetaS)*Sin(igdir)*Sin(phiL)*Sin(thetaL))/2. + (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) + 4*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*(((-0.5*(Sqrt(3)*Sin(igdir - phiL)*Sin(thetaL)) + Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + (((Sqrt(3)*Cos(igdir)*Cos(phiL)*Cos(thetaS)*Sin(thetaL))/2. + (Sqrt(3)*Cos(thetaS)*Sin(igdir)*Sin(phiL)*Sin(thetaL))/2. + (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))) - (2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))*(4*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS)*(((-0.5*(Sqrt(3)*Sin(igdir - phiL)*Sin(thetaL)) + Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + (((Sqrt(3)*Cos(igdir)*Cos(phiL)*Cos(thetaS)*Sin(thetaL))/2. + (Sqrt(3)*Cos(thetaS)*Sin(igdir)*Sin(phiL)*Sin(thetaL))/2. + (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) - 2*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*(((-0.5*(Sqrt(3)*Sin(igdir - phiL)*Sin(thetaL)) + Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + (((Sqrt(3)*Cos(igdir)*Cos(phiL)*Cos(thetaS)*Sin(thetaL))/2. + (Sqrt(3)*Cos(thetaS)*Sin(igdir)*Sin(phiL)*Sin(thetaL))/2. + (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2)))*Sin(ArcTan((2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))) + (Pi*(2*t*(2*f0 + f1*t) + (K*P*(f1*P*Cos(phi0) - f1*P*Cos(phi0 + (2*Pi*t)/P) + 2*f0*Pi*Sin(phi0) - 2*Pi*(f0 + f1*t)*Sin(phi0 + (2*Pi*t)/P)))/Power(Pi,2)))/2.))/(2.*(1 - Power(Cos(igdir - phiS),2)*Power(Sin(thetaS),2))*(1 + (4*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/(Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2)))) - ((1 + Cos(igdir - phiS)*Sin(thetaS))*Sqrt((Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4. + Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))*((4*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/(Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))) - (2*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))) + (2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(2*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*(((-0.5*(Sqrt(3)*Sin(igdir - phiL)*Sin(thetaL)) + Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + (((Sqrt(3)*Cos(igdir)*Cos(phiL)*Cos(thetaS)*Sin(thetaL))/2. + (Sqrt(3)*Cos(thetaS)*Sin(igdir)*Sin(phiL)*Sin(thetaL))/2. + (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) + 4*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*(((-0.5*(Sqrt(3)*Sin(igdir - phiL)*Sin(thetaL)) + Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + (((Sqrt(3)*Cos(igdir)*Cos(phiL)*Cos(thetaS)*Sin(thetaL))/2. + (Sqrt(3)*Cos(thetaS)*Sin(igdir)*Sin(phiL)*Sin(thetaL))/2. + (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))) - (2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))*(4*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS)*(((-0.5*(Sqrt(3)*Sin(igdir - phiL)*Sin(thetaL)) + Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + (((Sqrt(3)*Cos(igdir)*Cos(phiL)*Cos(thetaS)*Sin(thetaL))/2. + (Sqrt(3)*Cos(thetaS)*Sin(igdir)*Sin(phiL)*Sin(thetaL))/2. + (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) - 2*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*(((-0.5*(Sqrt(3)*Sin(igdir - phiL)*Sin(thetaL)) + Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + (((Sqrt(3)*Cos(igdir)*Cos(phiL)*Cos(thetaS)*Sin(thetaL))/2. + (Sqrt(3)*Cos(thetaS)*Sin(igdir)*Sin(phiL)*Sin(thetaL))/2. + (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2)))*Sin(ArcTan((2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))) + (Pi*(2*(2*f0 + f1*(t - T2))*(t - T2) + (K*P*(f1*P*Cos(phi0) - f1*P*Cos(phi0 + (2*Pi*(t - T2))/P) + 2*f0*Pi*Sin(phi0) - 2*Pi*(f0 + f1*(t - T2))*Sin(phi0 + (2*Pi*(t - T2))/P)))/Power(Pi,2)))/2.))/(2.*(1 - Power(Cos(igdir - phiS),2)*Power(Sin(thetaS),2))*(1 + (4*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/(Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2)))) + (Cos(igdir - phiS)*Sin(thetaS)*Sqrt((Power(A0,2)*Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/4. + Power(A0,2)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))*((4*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/(Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))) - (2*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS)*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))) + (2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(2*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*(((-0.5*(Sqrt(3)*Sin(igdir - phiL)*Sin(thetaL)) + Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + (((Sqrt(3)*Cos(igdir)*Cos(phiL)*Cos(thetaS)*Sin(thetaL))/2. + (Sqrt(3)*Cos(thetaS)*Sin(igdir)*Sin(phiL)*Sin(thetaL))/2. + (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) + 4*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*(((-0.5*(Sqrt(3)*Sin(igdir - phiL)*Sin(thetaL)) + Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + (((Sqrt(3)*Cos(igdir)*Cos(phiL)*Cos(thetaS)*Sin(thetaL))/2. + (Sqrt(3)*Cos(thetaS)*Sin(igdir)*Sin(phiL)*Sin(thetaL))/2. + (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))) - (2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))))*(4*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS)*(((-0.5*(Sqrt(3)*Sin(igdir - phiL)*Sin(thetaL)) + Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + (((Sqrt(3)*Cos(igdir)*Cos(phiL)*Cos(thetaS)*Sin(thetaL))/2. + (Sqrt(3)*Cos(thetaS)*Sin(igdir)*Sin(phiL)*Sin(thetaL))/2. + (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2))) - 2*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*(((-0.5*(Sqrt(3)*Sin(igdir - phiL)*Sin(thetaL)) + Cos(thetaS)*Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)) + (((Sqrt(3)*Cos(igdir)*Cos(phiL)*Cos(thetaS)*Sin(thetaL))/2. + (Sqrt(3)*Cos(thetaS)*Sin(igdir)*Sin(phiL)*Sin(thetaL))/2. + (Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2.)*(-0.5*Cos(thetaL) + (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. + Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))/(Power((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,2) + Power(Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)),2)))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2)))*Sin(ArcTan((2*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))*(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))/((1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2))*(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))))) + (Pi*(2*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.)*(2*f0 + f1*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.)) + (K*P*(f1*P*Cos(phi0) - f1*P*Cos(phi0 + (2*Pi*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.))/P) + 2*f0*Pi*Sin(phi0) - 2*Pi*(f0 + f1*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.))*Sin(phi0 + (2*Pi*(t - (T2*(1 + Cos(igdir - phiS)*Sin(thetaS)))/2.))/P)))/Power(Pi,2)))/2.))/((1 - Power(Cos(igdir - phiS),2)*Power(Sin(thetaS),2))*(1 + (4*Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2)*Power(-2*Cos(igdir - phiS)*Cos(thetaS)*Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*Sin(igdir - phiS) + (Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2))*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))/(Power(1 + Power(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS),2),2)*Power(Cos(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS))))*(Power(Cos(igdir - phiS),2)*Power(Cos(thetaS),2) - Power(Sin(igdir - phiS),2)) + 2*Cos(igdir - phiS)*Cos(thetaS)*Sin(igdir - phiS)*Sin(2*ArcTan((Sin(phiL - phiS)*Sin(thetaL)*Sin(thetaS))/2. - (Sqrt(3)*Sin(igdir)*(Cos(phiL)*Cos(thetaS)*Sin(thetaL) - Cos(phiS)*Cos(thetaL)*Sin(thetaS)))/2. - (Sqrt(3)*Cos(igdir)*(-(Cos(thetaS)*Sin(phiL)*Sin(thetaL)) + Cos(thetaL)*Sin(phiS)*Sin(thetaS)))/2.,Cos(thetaL)/2. - (Sqrt(3)*Cos(igdir - phiL)*Sin(thetaL))/2. - Cos(thetaS)*(Cos(thetaL)*Cos(thetaS) + Cos(phiL - phiS)*Sin(thetaL)*Sin(thetaS)))),2))));
	};
	return res;
};